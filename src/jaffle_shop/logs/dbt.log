[0m17:51:17.648124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054da2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068c6530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068c6a40>]}


============================== 17:51:17.650656 | f7cda069-4d0b-4dce-a337-7430a88ad509 ==============================
[0m17:51:17.650656 [info ] [MainThread]: Running with dbt=1.5.1
[0m17:51:17.650963 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/linhnguyen/.dbt', 'log_path': '/Users/linhnguyen/Demos/my-demo-dbt-app/src/jaffle_shop/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:51:17.651255 [info ] [MainThread]: dbt version: 1.5.1
[0m17:51:17.651412 [info ] [MainThread]: python version: 3.10.0
[0m17:51:17.651550 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.10/bin/python3.10
[0m17:51:17.651703 [info ] [MainThread]: os info: macOS-13.4-arm64-arm-64bit
[0m17:51:17.651924 [info ] [MainThread]: Using profiles.yml file at /Users/linhnguyen/.dbt/profiles.yml
[0m17:51:17.652082 [info ] [MainThread]: Using dbt_project.yml file at /Users/linhnguyen/Demos/my-demo-dbt-app/src/jaffle_shop/dbt_project.yml
[0m17:51:17.652302 [info ] [MainThread]: Configuration:
[0m17:51:17.851967 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:51:17.866493 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:51:17.866760 [info ] [MainThread]: Required dependencies:
[0m17:51:17.867041 [debug] [MainThread]: Executing "git --help"
[0m17:51:17.881146 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:51:17.881644 [debug] [MainThread]: STDERR: "b''"
[0m17:51:17.881814 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:51:17.882052 [info ] [MainThread]: Connection:
[0m17:51:17.882319 [info ] [MainThread]:   host: localhost
[0m17:51:17.882508 [info ] [MainThread]:   port: 5432
[0m17:51:17.882683 [info ] [MainThread]:   user: postgres
[0m17:51:17.882901 [info ] [MainThread]:   database: postgres
[0m17:51:17.883110 [info ] [MainThread]:   schema: jaffle_shop
[0m17:51:17.883271 [info ] [MainThread]:   search_path: None
[0m17:51:17.883452 [info ] [MainThread]:   keepalives_idle: 0
[0m17:51:17.883659 [info ] [MainThread]:   sslmode: None
[0m17:51:17.887681 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:51:17.888253 [debug] [MainThread]: Using postgres connection "debug"
[0m17:51:17.888384 [debug] [MainThread]: On debug: select 1 as id
[0m17:51:17.888536 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:51:17.899482 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m17:51:17.900343 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m17:51:17.900477 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m17:51:17.900629 [debug] [MainThread]: On debug: No close available on handle
[0m17:51:17.900782 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:51:17.900945 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:51:17.901098 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (::1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:51:17.901570 [debug] [MainThread]: Command `dbt debug` failed at 17:51:17.901495 after 0.28 seconds
[0m17:51:17.901756 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:51:17.901924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054da2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f39840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f39360>]}
[0m17:51:17.902157 [debug] [MainThread]: Flushing usage events
[0m17:52:04.645662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029b28f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b18490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b18bb0>]}


============================== 17:52:04.648022 | c5fc4c1f-09cc-4a3a-b134-4e0f02403900 ==============================
[0m17:52:04.648022 [info ] [MainThread]: Running with dbt=1.5.1
[0m17:52:04.648330 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/linhnguyen/.dbt', 'log_path': '/Users/linhnguyen/Demos/my-demo-dbt-app/src/jaffle_shop/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:52:04.648633 [info ] [MainThread]: dbt version: 1.5.1
[0m17:52:04.648797 [info ] [MainThread]: python version: 3.10.0
[0m17:52:04.648941 [info ] [MainThread]: python path: /Users/linhnguyen/Demos/dbt_env/bin/python3
[0m17:52:04.649082 [info ] [MainThread]: os info: macOS-13.4-arm64-arm-64bit
[0m17:52:04.649312 [info ] [MainThread]: Using profiles.yml file at /Users/linhnguyen/.dbt/profiles.yml
[0m17:52:04.649487 [info ] [MainThread]: Using dbt_project.yml file at /Users/linhnguyen/Demos/my-demo-dbt-app/src/jaffle_shop/dbt_project.yml
[0m17:52:04.649636 [info ] [MainThread]: Configuration:
[0m17:52:04.685549 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:52:04.696404 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:52:04.696641 [info ] [MainThread]: Required dependencies:
[0m17:52:04.696888 [debug] [MainThread]: Executing "git --help"
[0m17:52:04.709979 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:52:04.710456 [debug] [MainThread]: STDERR: "b''"
[0m17:52:04.710619 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:52:04.710798 [info ] [MainThread]: Connection:
[0m17:52:04.710989 [info ] [MainThread]:   host: localhost
[0m17:52:04.711143 [info ] [MainThread]:   port: 5432
[0m17:52:04.711275 [info ] [MainThread]:   user: postgres
[0m17:52:04.711407 [info ] [MainThread]:   database: postgres
[0m17:52:04.711567 [info ] [MainThread]:   schema: jaffle_shop
[0m17:52:04.711766 [info ] [MainThread]:   search_path: None
[0m17:52:04.711922 [info ] [MainThread]:   keepalives_idle: 0
[0m17:52:04.712058 [info ] [MainThread]:   sslmode: None
[0m17:52:04.715567 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:52:04.715939 [debug] [MainThread]: Using postgres connection "debug"
[0m17:52:04.716073 [debug] [MainThread]: On debug: select 1 as id
[0m17:52:04.716194 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:52:04.830480 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m17:52:04.831532 [debug] [MainThread]: On debug: Close
[0m17:52:04.831751 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:52:04.831981 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:52:04.832520 [debug] [MainThread]: Command `dbt debug` succeeded at 17:52:04.832438 after 0.21 seconds
[0m17:52:04.832720 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:52:04.832942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029b28f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c01f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c03160>]}
[0m17:52:04.833235 [debug] [MainThread]: Flushing usage events
[0m17:52:15.824539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050c2890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062284f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106228c10>]}


============================== 17:52:15.826907 | 301946f8-b833-4946-a917-981d668ae5a2 ==============================
[0m17:52:15.826907 [info ] [MainThread]: Running with dbt=1.5.1
[0m17:52:15.827203 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/linhnguyen/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/linhnguyen/Demos/my-demo-dbt-app/src/jaffle_shop/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:52:15.860484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '301946f8-b833-4946-a917-981d668ae5a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ba8c0>]}
[0m17:52:15.866825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '301946f8-b833-4946-a917-981d668ae5a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062e52a0>]}
[0m17:52:15.869744 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m17:52:15.870515 [debug] [MainThread]: Command `dbt run` failed at 17:52:15.870429 after 0.06 seconds
[0m17:52:15.870750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050c2890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062e68c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062e4a90>]}
[0m17:52:15.870965 [debug] [MainThread]: Flushing usage events
[0m17:52:22.645092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105012830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106178430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106178b20>]}


============================== 17:52:22.647648 | 0d5d7645-7578-4660-93ab-8582a9745b63 ==============================
[0m17:52:22.647648 [info ] [MainThread]: Running with dbt=1.5.1
[0m17:52:22.647956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/linhnguyen/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/linhnguyen/Demos/my-demo-dbt-app/src/jaffle_shop/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:52:22.661607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d5d7645-7578-4660-93ab-8582a9745b63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106178ac0>]}
[0m17:52:22.663493 [debug] [MainThread]: Set downloads directory='/var/folders/zv/4qgtqcc13rx62rbftrjhw5t40000gn/T/dbt-downloads-dkybboht'
[0m17:52:22.663771 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:52:23.039791 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:52:23.042823 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:52:23.284372 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:52:23.289251 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:52:24.898037 [info ] [MainThread]: Installed from version 1.0.0
[0m17:52:24.898318 [info ] [MainThread]: Updated version available: 1.1.1
[0m17:52:24.898531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0d5d7645-7578-4660-93ab-8582a9745b63', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061de4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061dc2e0>]}
[0m17:52:24.898741 [info ] [MainThread]: 
[0m17:52:24.898904 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m17:52:24.899550 [debug] [MainThread]: Command `dbt deps` succeeded at 17:52:24.899461 after 2.27 seconds
[0m17:52:24.899749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105012830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10610af80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10617bb50>]}
[0m17:52:24.899924 [debug] [MainThread]: Flushing usage events
[0m17:52:28.316204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054aa8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106614550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106614c70>]}


============================== 17:52:28.318480 | a97871af-935a-4482-92b3-8dfec29182d1 ==============================
[0m17:52:28.318480 [info ] [MainThread]: Running with dbt=1.5.1
[0m17:52:28.318780 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/linhnguyen/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/linhnguyen/Demos/my-demo-dbt-app/src/jaffle_shop/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:52:28.360875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a97871af-935a-4482-92b3-8dfec29182d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065a3040>]}
[0m17:52:28.367652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a97871af-935a-4482-92b3-8dfec29182d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d1480>]}
[0m17:52:28.380471 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m17:52:28.380850 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:52:28.381056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a97871af-935a-4482-92b3-8dfec29182d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d2bf0>]}
[0m17:52:28.799350 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m17:52:28.809054 [debug] [MainThread]: 1603: static parser failed on orders.sql
[0m17:52:28.815039 [debug] [MainThread]: 1602: parser fallback to jinja rendering on orders.sql
[0m17:52:28.816130 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customers.sql
[0m17:52:28.817901 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_payments.sql
[0m17:52:28.819714 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_orders.sql
[0m17:52:28.915101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a97871af-935a-4482-92b3-8dfec29182d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eed120>]}
[0m17:52:28.920715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a97871af-935a-4482-92b3-8dfec29182d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d1810>]}
[0m17:52:28.920979 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 419 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m17:52:28.921166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a97871af-935a-4482-92b3-8dfec29182d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d3a60>]}
[0m17:52:28.922146 [info ] [MainThread]: 
[0m17:52:28.922564 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:52:28.923123 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:52:28.928320 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:52:28.928508 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:52:28.928639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:52:29.016745 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:52:29.017623 [debug] [ThreadPool]: On list_postgres: Close
[0m17:52:29.018599 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_jaffle_shop)
[0m17:52:29.022210 [debug] [ThreadPool]: Using postgres connection "list_postgres_jaffle_shop"
[0m17:52:29.022414 [debug] [ThreadPool]: On list_postgres_jaffle_shop: BEGIN
[0m17:52:29.022540 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:52:29.046915 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:52:29.047135 [debug] [ThreadPool]: Using postgres connection "list_postgres_jaffle_shop"
[0m17:52:29.047295 [debug] [ThreadPool]: On list_postgres_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_jaffle_shop"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'jaffle_shop'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'jaffle_shop'
  
[0m17:52:29.089071 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m17:52:29.089871 [debug] [ThreadPool]: On list_postgres_jaffle_shop: ROLLBACK
[0m17:52:29.091031 [debug] [ThreadPool]: On list_postgres_jaffle_shop: Close
[0m17:52:29.094357 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:29.094530 [debug] [MainThread]: On master: BEGIN
[0m17:52:29.094651 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:52:29.118271 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:52:29.118518 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:29.118731 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:52:29.190162 [debug] [MainThread]: SQL status: SELECT 46 in 0.0 seconds
[0m17:52:29.195403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a97871af-935a-4482-92b3-8dfec29182d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f6b670>]}
[0m17:52:29.196131 [debug] [MainThread]: On master: ROLLBACK
[0m17:52:29.197672 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:29.198060 [debug] [MainThread]: On master: BEGIN
[0m17:52:29.199292 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:52:29.199580 [debug] [MainThread]: On master: COMMIT
[0m17:52:29.199857 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:29.200142 [debug] [MainThread]: On master: COMMIT
[0m17:52:29.201031 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:52:29.201398 [debug] [MainThread]: On master: Close
[0m17:52:29.202293 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:52:29.202811 [info ] [MainThread]: 
[0m17:52:29.208964 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m17:52:29.209201 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m17:52:29.209426 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m17:52:29.209920 [info ] [Thread-1 (]: 1 of 5 START sql view model jaffle_shop.stg_customers .......................... [RUN]
[0m17:52:29.210211 [info ] [Thread-2 (]: 2 of 5 START sql view model jaffle_shop.stg_orders ............................. [RUN]
[0m17:52:29.210478 [info ] [Thread-3 (]: 3 of 5 START sql view model jaffle_shop.stg_payments ........................... [RUN]
[0m17:52:29.210860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_jaffle_shop, now model.jaffle_shop.stg_customers)
[0m17:52:29.211220 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_orders'
[0m17:52:29.211815 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_payments'
[0m17:52:29.212113 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m17:52:29.212281 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m17:52:29.212429 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m17:52:29.214457 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m17:52:29.216051 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m17:52:29.217599 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m17:52:29.218291 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 17:52:29.212547 => 17:52:29.218179
[0m17:52:29.218500 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 17:52:29.214621 => 17:52:29.218400
[0m17:52:29.218783 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 17:52:29.216179 => 17:52:29.218627
[0m17:52:29.218923 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m17:52:29.219073 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m17:52:29.219203 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m17:52:29.265724 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m17:52:29.268001 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m17:52:29.268250 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m17:52:29.268949 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m17:52:29.269145 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m17:52:29.269302 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m17:52:29.269443 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m17:52:29.269589 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m17:52:29.269738 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m17:52:29.269887 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:52:29.270032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:29.270185 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:52:29.317882 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:52:29.318444 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m17:52:29.318685 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "postgres"."jaffle_shop"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "postgres"."jaffle_shop"."raw_customers"

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name

    from source

)

select * from renamed
  );
[0m17:52:29.318969 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:52:29.319276 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m17:52:29.319465 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "postgres"."jaffle_shop"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "postgres"."jaffle_shop"."raw_orders"

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed
  );
[0m17:52:29.319756 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:52:29.319905 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m17:52:29.320059 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "postgres"."jaffle_shop"."stg_payments__dbt_tmp"
    
    
  as (
    with source as (
    select * from "postgres"."jaffle_shop"."raw_payments"

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        -- `amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );
[0m17:52:29.352480 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:52:29.356386 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m17:52:29.356628 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:52:29.356888 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "postgres"."jaffle_shop"."stg_orders" rename to "stg_orders__dbt_backup"
[0m17:52:29.358647 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m17:52:29.358911 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "postgres"."jaffle_shop"."stg_customers" rename to "stg_customers__dbt_backup"
[0m17:52:29.361852 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:52:29.362335 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:52:29.364171 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m17:52:29.364372 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:52:29.365861 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m17:52:29.366034 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "postgres"."jaffle_shop"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m17:52:29.367532 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m17:52:29.367699 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "postgres"."jaffle_shop"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m17:52:29.367915 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "postgres"."jaffle_shop"."stg_payments" rename to "stg_payments__dbt_backup"
[0m17:52:29.371727 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:52:29.378999 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:52:29.381815 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m17:52:29.382045 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:52:29.384429 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m17:52:29.385102 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m17:52:29.387228 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m17:52:29.386834 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m17:52:29.387464 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m17:52:29.387606 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m17:52:29.387064 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "postgres"."jaffle_shop"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m17:52:29.392202 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:52:29.392442 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:52:29.395538 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m17:52:29.395749 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:52:29.397147 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m17:52:29.397337 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "postgres"."jaffle_shop"."stg_orders__dbt_backup" cascade
[0m17:52:29.398379 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m17:52:29.398553 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "postgres"."jaffle_shop"."stg_customers__dbt_backup" cascade
[0m17:52:29.398750 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m17:52:29.398936 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m17:52:29.405151 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m17:52:29.406585 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m17:52:29.406773 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:52:29.406940 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "postgres"."jaffle_shop"."stg_payments__dbt_backup" cascade
[0m17:52:29.407635 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 17:52:29.224924 => 17:52:29.407546
[0m17:52:29.407839 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m17:52:29.408215 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a97871af-935a-4482-92b3-8dfec29182d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e4b4f0>]}
[0m17:52:29.408514 [info ] [Thread-2 (]: 2 of 5 OK created sql view model jaffle_shop.stg_orders ........................ [[32mCREATE VIEW[0m in 0.20s]
[0m17:52:29.408808 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m17:52:29.409734 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:52:29.410463 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 17:52:29.219294 => 17:52:29.410375
[0m17:52:29.410627 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m17:52:29.410946 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a97871af-935a-4482-92b3-8dfec29182d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc0220>]}
[0m17:52:29.411205 [info ] [Thread-1 (]: 1 of 5 OK created sql view model jaffle_shop.stg_customers ..................... [[32mCREATE VIEW[0m in 0.20s]
[0m17:52:29.411532 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m17:52:29.416111 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:52:29.416961 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 17:52:29.265903 => 17:52:29.416866
[0m17:52:29.417129 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m17:52:29.417462 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a97871af-935a-4482-92b3-8dfec29182d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e15ba0>]}
[0m17:52:29.417721 [info ] [Thread-3 (]: 3 of 5 OK created sql view model jaffle_shop.stg_payments ...................... [[32mCREATE VIEW[0m in 0.21s]
[0m17:52:29.418089 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m17:52:29.418495 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m17:52:29.418675 [debug] [Thread-2 (]: Began running node model.jaffle_shop.orders
[0m17:52:29.418890 [info ] [Thread-4 (]: 4 of 5 START sql table model jaffle_shop.customers ............................. [RUN]
[0m17:52:29.419187 [info ] [Thread-2 (]: 5 of 5 START sql table model jaffle_shop.orders ................................ [RUN]
[0m17:52:29.419580 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.jaffle_shop.customers'
[0m17:52:29.419864 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.orders)
[0m17:52:29.420024 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m17:52:29.420170 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.orders
[0m17:52:29.422154 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m17:52:29.424228 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.orders"
[0m17:52:29.424642 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 17:52:29.420271 => 17:52:29.424548
[0m17:52:29.424824 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.orders (compile): 17:52:29.422281 => 17:52:29.424739
[0m17:52:29.424977 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m17:52:29.425128 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.orders
[0m17:52:29.437577 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m17:52:29.439969 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.orders"
[0m17:52:29.440402 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.customers"
[0m17:52:29.440583 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.orders"
[0m17:52:29.440746 [debug] [Thread-4 (]: On model.jaffle_shop.customers: BEGIN
[0m17:52:29.440906 [debug] [Thread-2 (]: On model.jaffle_shop.orders: BEGIN
[0m17:52:29.441065 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:52:29.441210 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:52:29.469807 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:52:29.470069 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:52:29.470269 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.customers"
[0m17:52:29.470448 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.orders"
[0m17:52:29.470639 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  
    

  create  table "postgres"."jaffle_shop"."customers__dbt_tmp"
  
  
    as
  
  (
    with customers as (

    select * from "postgres"."jaffle_shop"."stg_customers"

),

orders as (

    select * from "postgres"."jaffle_shop"."stg_orders"

),

payments as (

    select * from "postgres"."jaffle_shop"."stg_payments"

),

customer_orders as (

        select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by customer_id

),

customer_payments as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders on
         payments.order_id = orders.order_id

    group by orders.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders
        on customers.customer_id = customer_orders.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
  
[0m17:52:29.470858 [debug] [Thread-2 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.orders"} */

  
    

  create  table "postgres"."jaffle_shop"."orders__dbt_tmp"
  
  
    as
  
  (
    

with orders as (

    select * from "postgres"."jaffle_shop"."stg_orders"

),

payments as (

    select * from "postgres"."jaffle_shop"."stg_payments"

),

order_payments as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by order_id

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders


    left join order_payments
        on orders.order_id = order_payments.order_id

)

select * from final
  );
  
[0m17:52:29.528215 [debug] [Thread-2 (]: SQL status: SELECT 99 in 0.0 seconds
[0m17:52:29.530058 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.orders"
[0m17:52:29.530265 [debug] [Thread-4 (]: SQL status: SELECT 100 in 0.0 seconds
[0m17:52:29.530428 [debug] [Thread-2 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.orders"} */
alter table "postgres"."jaffle_shop"."orders" rename to "orders__dbt_backup"
[0m17:52:29.532101 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.customers"
[0m17:52:29.532318 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
alter table "postgres"."jaffle_shop"."customers" rename to "customers__dbt_backup"
[0m17:52:29.534233 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:52:29.534456 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:52:29.536025 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.orders"
[0m17:52:29.537460 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.customers"
[0m17:52:29.537618 [debug] [Thread-2 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.orders"} */
alter table "postgres"."jaffle_shop"."orders__dbt_tmp" rename to "orders"
[0m17:52:29.537765 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
alter table "postgres"."jaffle_shop"."customers__dbt_tmp" rename to "customers"
[0m17:52:29.538985 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:52:29.539136 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:52:29.542040 [debug] [Thread-2 (]: On model.jaffle_shop.orders: COMMIT
[0m17:52:29.543077 [debug] [Thread-4 (]: On model.jaffle_shop.customers: COMMIT
[0m17:52:29.543236 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.orders"
[0m17:52:29.543402 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.customers"
[0m17:52:29.543550 [debug] [Thread-2 (]: On model.jaffle_shop.orders: COMMIT
[0m17:52:29.543700 [debug] [Thread-4 (]: On model.jaffle_shop.customers: COMMIT
[0m17:52:29.546655 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m17:52:29.546831 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:52:29.548265 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.customers"
[0m17:52:29.550153 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.orders"
[0m17:52:29.550324 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
drop table if exists "postgres"."jaffle_shop"."customers__dbt_backup" cascade
[0m17:52:29.550510 [debug] [Thread-2 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.orders"} */
drop table if exists "postgres"."jaffle_shop"."orders__dbt_backup" cascade
[0m17:52:29.557413 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:52:29.557628 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:52:29.558260 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.orders (execute): 17:52:29.437745 => 17:52:29.558179
[0m17:52:29.558904 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 17:52:29.425237 => 17:52:29.558820
[0m17:52:29.559053 [debug] [Thread-2 (]: On model.jaffle_shop.orders: Close
[0m17:52:29.559191 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m17:52:29.559561 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a97871af-935a-4482-92b3-8dfec29182d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d0c280>]}
[0m17:52:29.559867 [info ] [Thread-2 (]: 5 of 5 OK created sql table model jaffle_shop.orders ........................... [[32mSELECT 99[0m in 0.14s]
[0m17:52:29.560162 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.orders
[0m17:52:29.560595 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a97871af-935a-4482-92b3-8dfec29182d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d0de40>]}
[0m17:52:29.560926 [info ] [Thread-4 (]: 4 of 5 OK created sql table model jaffle_shop.customers ........................ [[32mSELECT 100[0m in 0.14s]
[0m17:52:29.561220 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m17:52:29.561945 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:29.562070 [debug] [MainThread]: On master: BEGIN
[0m17:52:29.562178 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:52:29.586766 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:52:29.587004 [debug] [MainThread]: On master: COMMIT
[0m17:52:29.587141 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:29.587258 [debug] [MainThread]: On master: COMMIT
[0m17:52:29.587849 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:52:29.587980 [debug] [MainThread]: On master: Close
[0m17:52:29.588309 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:52:29.588429 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m17:52:29.588534 [debug] [MainThread]: Connection 'model.jaffle_shop.orders' was properly closed.
[0m17:52:29.588634 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m17:52:29.588731 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m17:52:29.588874 [info ] [MainThread]: 
[0m17:52:29.589045 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m17:52:29.589645 [debug] [MainThread]: Command end result
[0m17:52:29.594808 [info ] [MainThread]: 
[0m17:52:29.595111 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:52:29.595306 [info ] [MainThread]: 
[0m17:52:29.595528 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:52:29.595843 [debug] [MainThread]: Command `dbt run` succeeded at 17:52:29.595793 after 1.30 seconds
[0m17:52:29.596005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054aa8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d0c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cc4520>]}
[0m17:52:29.596170 [debug] [MainThread]: Flushing usage events


============================== 2023-06-16 10:53:16.979418 | 74781400-dbac-4524-b2c4-1b4e5c5eb3d4 ==============================
[0m10:53:16.979425 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:53:16.980089 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m10:53:16.980663 [debug] [MainThread]: Tracking: tracking
[0m10:53:16.982513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4af0790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4af21d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4af3b50>]}
[0m10:53:16.986245 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-39cjldo1'
[0m10:53:16.986785 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:53:17.152107 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:53:17.153998 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:53:17.278882 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:53:17.314281 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:53:18.568606 [info ] [MainThread]:   Installed from version 1.0.0
[0m10:53:18.569279 [info ] [MainThread]:   Updated version available: 1.1.1
[0m10:53:18.569886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '74781400-dbac-4524-b2c4-1b4e5c5eb3d4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4af0b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4af2650>]}
[0m10:53:18.570451 [info ] [MainThread]: 
[0m10:53:18.570938 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m10:53:18.571658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4b119c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4af3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4af3910>]}
[0m10:53:18.572354 [debug] [MainThread]: Flushing usage events


============================== 2023-06-16 10:53:21.327377 | 8a4694c5-0e4e-4280-bf67-5f9d6be4e0af ==============================
[0m10:53:21.327385 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:53:21.327883 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/jaffle_shop/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m10:53:21.328602 [debug] [MainThread]: Tracking: tracking
[0m10:53:21.330310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6907910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6907820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6907880>]}
[0m10:53:21.355627 [debug] [MainThread]: Failed to load parsed file from disk at /usr/src/dbt/jaffle_shop/target/partial_parse.msgpack: Field "nodes" of type MutableMapping[str, Union[CompiledAnalysisNode, CompiledSingularTestNode, CompiledModelNode, CompiledHookNode, CompiledRPCNode, CompiledSqlNode, CompiledGenericTestNode, CompiledSeedNode, CompiledSnapshotNode, ParsedAnalysisNode, ParsedSingularTestNode, ParsedHookNode, ParsedModelNode, ParsedRPCNode, ParsedSqlNode, ParsedGenericTestNode, ParsedSeedNode, ParsedSnapshotNode]] in Manifest has invalid value {'model.jaffle_shop.customers': {'database': 'postgres', 'schema': 'jaffle_shop', 'name': 'customers', 'resource_type': 'model', 'package_name': 'jaffle_shop', 'path': 'customers.sql', 'original_file_path': 'models/customers.sql', 'unique_id': 'model.jaffle_shop.customers', 'fqn': ['jaffle_shop', 'customers'], 'alias': 'customers', 'checksum': {'name': 'sha256', 'checksum': '60bd72e33da43fff3a7e7609135c17cd4468bd22afec0735dd36018bfb5af30a'}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'group': None, 'materialized': 'table', 'incremental_strategy': None, 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'packages': [], 'docs': {'show': True, 'node_color': None}, 'contract': {'enforced': False}, 'post-hook': [], 'pre-hook': []}, 'tags': [], 'description': "This table has basic information about a customer, as well as some derived facts based on a customer's orders", 'columns': {'customer_id': {'name': 'customer_id', 'description': 'This is a unique identifier for a customer', 'meta': {}, 'data_type': None, 'constraints': [], 'quote': None, 'tags': []}, 'first_name': {'name': 'first_name', 'description': "Customer's first name. PII.", 'meta': {}, 'data_type': None, 'constraints': [], 'quote': None, 'tags': []}, 'last_name': {'name': 'last_name', 'description': "Customer's last name. PII.", 'meta': {}, 'data_type': None, 'constraints': [], 'quote': None, 'tags': []}, 'first_order': {'name': 'first_order', 'description': "Date (UTC) of a customer's first order", 'meta': {}, 'data_type': None, 'constraints': [], 'quote': None, 'tags': []}, 'most_recent_order': {'name': 'most_recent_order', 'description': "Date (UTC) of a customer's most recent order", 'meta': {}, 'data_type': None, 'constraints': [], 'quote': None, 'tags': []}, 'number_of_orders': {'name': 'number_of_orders', 'description': 'Count of the number of orders a customer has placed', 'meta': {}, 'data_type': None, 'constraints': [], 'quote': None, 'tags': []}, 'total_order_amount': {'name': 'total_order_amount', 'description': "Total value (AUD) of a customer's orders", 'meta': {}, 'data_type': None, 'constraints': [], 'quote': None, 'tags': []}}, 'meta': {}, 'group': None, 'docs': {'show': True, 'node_color': None}, 'patch_path': 'jaffle_shop://models/schema.yml', 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1686912748.850452, 'config_call_dict': {}, 'relation_name': '"postgres"."jaffle_shop"."customers"', 'raw_code': "with customers as (\n\n    select * from {{ ref('stg_customers') }}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n\n    select * from {{ ref('stg_payments') }}\n\n),\n\ncustomer_orders as (\n\n        select\n        customer_id,\n\n        min(order_date) as first_order,\n        max(order_date) as most_recent_order,\n        count(order_id) as number_of_orders\n    from orders\n\n    group by customer_id\n\n),\n\ncustomer_payments as (\n\n    select\n        orders.customer_id,\n        sum(amount) as total_amount\n\n    from payments\n\n    left join orders on\n         payments.order_id = orders.order_id\n\n    group by orders.customer_id\n\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order,\n        customer_orders.most_recent_order,\n        customer_orders.number_of_orders,\n        customer_payments.total_amount as customer_lifetime_value\n\n    from customers\n\n    left join customer_orders\n        on customers.customer_id = customer_orders.customer_id\n\n    left join customer_payments\n        on  customers.customer_id = customer_payments.customer_id\n\n)\n\nselect * from final", 'language': 'sql', 'refs': [{'name': 'stg_customers', 'package': None, 'version': None}, {'name': 'stg_orders', 'package': None, 'version': None}, {'name': 'stg_payments', 'package': None, 'version': None}], 'sources': [], 'metrics': [], 'depends_on': {'macros': [], 'nodes': ['model.jaffle_shop.stg_customers', 'model.jaffle_shop.stg_orders', 'model.jaffle_shop.stg_payments']}, 'compiled_path': None, 'contract': {'enforced': False, 'checksum': None}, 'access': 'protected', 'constraints': [], 'version': None, 'latest_version': None}, 'model.jaffle_shop.orders': {'database': 'postgres', 'schema': 'jaffle_shop', 'name': 'orders', 'resource_type': 'model', 'package_name': 'jaffle_shop', 'path': 'orders.sql', 'original_file_path': 'models/orders.sql', 'unique_id': 'model.jaffle_shop.orders', 'fqn': ['jaffle_shop', 'orders'], 'alias': 'orders', 'checksum': {'name': 'sha256', 'checksum': '27f8c79aad1cfd8411ab9c3d2ce8da1d787f7f05c58bbee1d247510dc426be0f'}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'group': None, 'materialized': 'table', 'incremental_strategy': None, 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'packages': [], 'docs': {'show': True, 'node_color': None}, 'contract': {'enforced': False}, 'post-hook': [], 'pre-hook': []}, 'tags': [], 'description': 'This table has basic information about orders, as well as some derived facts based on payments', 'columns': {'order_id': {'name': 'order_id', 'description': 'This is a unique identifier for an order', 'meta': {}, 'data_type': None, 'constraints': [], 'quote': None, 'tags': []}, 'customer_id': {'name': 'customer_id', 'description': 'Foreign key to the customers table', 'meta': {}, 'data_type': None, 'constraints': [], 'quote': None, 'tags': []}, 'order_date': {'name': 'order_date', 'description': 'Date (UTC) that the order was placed', 'meta': {}, 'data_type': None, 'constraints': [], 'quote': None, 'tags': []}, 'status': {'name': 'status', 'description': 'Orders can be one of the following statuses:\n\n| status         | description                                                                                                            |\n|----------------|------------------------------------------------------------------------------------------------------------------------|\n| placed         | The order has been placed but has not yet left the warehouse                                                           |\n| shipped        | The order has ben shipped to the customer and is currently in transit                                                  |\n| completed      | The order has been received by the customer                                                                            |\n| return_pending | The customer has indicated that they would like to return the order, but it has not yet been received at the warehouse |\n| returned       | The order has been returned by the customer and received at the warehouse                                              |', 'meta': {}, 'data_type': None, 'constraints': [], 'quote': None, 'tags': []}, 'amount': {'name': 'amount', 'description': 'Total amount (AUD) of the order', 'meta': {}, 'data_type': None, 'constraints': [], 'quote': None, 'tags': []}, 'credit_card_amount': {'name': 'credit_card_amount', 'description': 'Amount of the order (AUD) paid for by credit card', 'meta': {}, 'data_type': None, 'constraints': [], 'quote': None, 'tags': []}, 'coupon_amount': {'name': 'coupon_amount', 'description': 'Amount of the order (AUD) paid for by coupon', 'meta': {}, 'data_type': None, 'constraints': [], 'quote': None, 'tags': []}, 'bank_transfer_amount': {'name': 'bank_transfer_amount', 'description': 'Amount of the order (AUD) paid for by bank transfer', 'meta': {}, 'data_type': None, 'constraints': [], 'quote': None, 'tags': []}, 'gift_card_amount': {'name': 'gift_card_amount', 'description': 'Amount of the order (AUD) paid for by gift card', 'meta': {}, 'data_type': None, 'constraints': [], 'quote': None, 'tags': []}}, 'meta': {}, 'group': None, 'docs': {'show': True, 'node_color': None}, 'patch_path': 'jaffle_shop://models/schema.yml', 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1686912748.852364, 'config_call_dict': {}, 'relation_name': '"postgres"."jaffle_shop"."orders"', 'raw_code': "{% set payment_methods = ['credit_card', 'coupon', 'bank_transfer', 'gift_card'] %}\n\nwith orders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n\n    select * from {{ ref('stg_payments') }}\n\n),\n\norder_payments as (\n\n    select\n        order_id,\n\n        {% for payment_method in payment_methods -%}\n        sum(case when payment_method = '{{ payment_method }}' then amount else 0 end) as {{ payment_method }}_amount,\n        {% endfor -%}\n\n        sum(amount) as total_amount\n\n    from payments\n\n    group by order_id\n\n),\n\nfinal as (\n\n    select\n        orders.order_id,\n        orders.customer_id,\n        orders.order_date,\n        orders.status,\n\n        {% for payment_method in payment_methods -%}\n\n        order_payments.{{ payment_method }}_amount,\n\n        {% endfor -%}\n\n        order_payments.total_amount as amount\n\n    from orders\n\n\n    left join order_payments\n        on orders.order_id = order_payments.order_id\n\n)\n\nselect * from final", 'language': 'sql', 'refs': [{'name': 'stg_orders', 'package': None, 'version': None}, {'name': 'stg_payments', 'package': None, 'version': None}], 'sources': [], 'metrics': [], 'depends_on': {'macros': [], 'nodes': ['model.jaffle_shop.stg_orders', 'model.jaffle_shop.stg_payments']}, 'compiled_path': None, 'contract': {'enforced': False, 'checksum': None}, 'access': 'protected', 'constraints': [], 'version': None, 'latest_version': None}, 'model.jaffle_shop.stg_customers': {'database': 'postgres', 'schema': 'jaffle_shop', 'name': 'stg_customers', 'resource_type': 'model', 'package_name': 'jaffle_shop', 'path': 'staging/stg_customers.sql', 'original_file_path': 'models/staging/stg_customers.sql', 'unique_id': 'model.jaffle_shop.stg_customers', 'fqn': ['jaffle_shop', 'staging', 'stg_customers'], 'alias': 'stg_customers', 'checksum': {'name': 'sha256', 'checksum': '80e3223cd54387e11fa16cd0f4cbe15f8ff74dcd9900b93856b9e39416178c9d'}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'group': None, 'materialized': 'view', 'incremental_strategy': None, 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'packages': [], 'docs': {'show': True, 'node_color': None}, 'contract': {'enforced': False}, 'post-hook': [], 'pre-hook': []}, 'tags': [], 'description': '', 'columns': {'customer_id': {'name': 'customer_id', 'description': '', 'meta': {}, 'data_type': None, 'constraints': [], 'quote': None, 'tags': []}}, 'meta': {}, 'group': None, 'docs': {'show': True, 'node_color': None}, 'patch_path': 'jaffle_shop://models/staging/schema.yml', 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'view'}, 'created_at': 1686912748.88205, 'config_call_dict': {}, 'relation_name': '"postgres"."jaffle_shop"."stg_customers"', 'raw_code': "with source as (\n\n    {#-\n    Normally we would select from the table here, but we are using seeds to load\n    our data in this project\n    #}\n    select * from {{ ref('raw_customers') }}\n\n),\n\nrenamed as (\n\n    select\n        id as customer_id,\n        first_name,\n        last_name\n\n    from source\n\n)\n\nselect * from renamed", 'language': 'sql', 'refs': [{'name': 'raw_customers', 'package': None, 'version': None}], 'sources': [], 'metrics': [], 'depends_on': {'macros': [], 'nodes': ['seed.jaffle_shop.raw_customers']}, 'compiled_path': None, 'contract': {'enforced': False, 'checksum': None}, 'access': 'protected', 'constraints': [], 'version': None, 'latest_version': None}, 'model.jaffle_shop.stg_payments': {'database': 'postgres', 'schema': 'jaffle_shop', 'name': 'stg_payments', 'resource_type': 'model', 'package_name': 'jaffle_shop', 'path': 'staging/stg_payments.sql', 'original_file_path': 'models/staging/stg_payments.sql', 'unique_id': 'model.jaffle_shop.stg_payments', 'fqn': ['jaffle_shop', 'staging', 'stg_payments'], 'alias': 'stg_payments', 'checksum': {'name': 'sha256', 'checksum': '9c1ee3bfb10e07c2dfc325d55925da0e521887136d9051768cb8acf09dc86bda'}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'group': None, 'materialized': 'view', 'incremental_strategy': None, 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'packages': [], 'docs': {'show': True, 'node_color': None}, 'contract': {'enforced': False}, 'post-hook': [], 'pre-hook': []}, 'tags': [], 'description': '', 'columns': {'payment_id': {'name': 'payment_id', 'description': '', 'meta': {}, 'data_type': None, 'constraints': [], 'quote': None, 'tags': []}, 'payment_method': {'name': 'payment_method', 'description': '', 'meta': {}, 'data_type': None, 'constraints': [], 'quote': None, 'tags': []}}, 'meta': {}, 'group': None, 'docs': {'show': True, 'node_color': None}, 'patch_path': 'jaffle_shop://models/staging/schema.yml', 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'view'}, 'created_at': 1686912748.8833761, 'config_call_dict': {}, 'relation_name': '"postgres"."jaffle_shop"."stg_payments"', 'raw_code': "with source as (\n    \n    {#-\n    Normally we would select from the table here, but we are using seeds to load\n    our data in this project\n    #}\n    select * from {{ ref('raw_payments') }}\n\n),\n\nrenamed as (\n\n    select\n        id as payment_id,\n        order_id,\n        payment_method,\n\n        -- `amount` is currently stored in cents, so we convert it to dollars\n        amount / 100 as amount\n\n    from source\n\n)\n\nselect * from renamed", 'language': 'sql', 'refs': [{'name': 'raw_payments', 'package': None, 'version': None}], 'sources': [], 'metrics': [], 'depends_on': {'macros': [], 'nodes': ['seed.jaffle_shop.raw_payments']}, 'compiled_path': None, 'contract': {'enforced': False, 'checksum': None}, 'access': 'protected', 'constraints': [], 'version': None, 'latest_version': None}, 'model.jaffle_shop.stg_orders': {'database': 'postgres', 'schema': 'jaffle_shop', 'name': 'stg_orders', 'resource_type': 'model', 'package_name': 'jaffle_shop', 'path': 'staging/stg_orders.sql', 'original_file_path': 'models/staging/stg_orders.sql', 'unique_id': 'model.jaffle_shop.stg_orders', 'fqn': ['jaffle_shop', 'staging', 'stg_orders'], 'alias': 'stg_orders', 'checksum': {'name': 'sha256', 'checksum': 'f4f881cb09d2c4162200fc331d7401df6d1abd4fed492554a7db70dede347108'}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'group': None, 'materialized': 'view', 'incremental_strategy': None, 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'packages': [], 'docs': {'show': True, 'node_color': None}, 'contract': {'enforced': False}, 'post-hook': [], 'pre-hook': []}, 'tags': [], 'description': '', 'columns': {'order_id': {'name': 'order_id', 'description': '', 'meta': {}, 'data_type': None, 'constraints': [], 'quote': None, 'tags': []}, 'status': {'name': 'status', 'description': '', 'meta': {}, 'data_type': None, 'constraints': [], 'quote': None, 'tags': []}}, 'meta': {}, 'group': None, 'docs': {'show': True, 'node_color': None}, 'patch_path': 'jaffle_shop://models/staging/schema.yml', 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'view'}, 'created_at': 1686912748.882658, 'config_call_dict': {}, 'relation_name': '"postgres"."jaffle_shop"."stg_orders"', 'raw_code': "with source as (\n\n    {#-\n    Normally we would select from the table here, but we are using seeds to load\n    our data in this project\n    #}\n    select * from {{ ref('raw_orders') }}\n\n),\n\nrenamed as (\n\n    select\n        id as order_id,\n        user_id as customer_id,\n        order_date,\n        status\n\n    from source\n\n)\n\nselect * from renamed", 'language': 'sql', 'refs': [{'name': 'raw_orders', 'package': None, 'version': None}], 'sources': [], 'metrics': [], 'depends_on': {'macros': [], 'nodes': ['seed.jaffle_shop.raw_orders']}, 'compiled_path': None, 'contract': {'enforced': False, 'checksum': None}, 'access': 'protected', 'constraints': [], 'version': None, 'latest_version': None}, 'seed.jaffle_shop.raw_customers': {'database': 'postgres', 'schema': 'jaffle_shop', 'name': 'raw_customers', 'resource_type': 'seed', 'package_name': 'jaffle_shop', 'path': 'raw_customers.csv', 'original_file_path': 'seeds/raw_customers.csv', 'unique_id': 'seed.jaffle_shop.raw_customers', 'fqn': ['jaffle_shop', 'raw_customers'], 'alias': 'raw_customers', 'checksum': {'name': 'sha256', 'checksum': '357d173dda65a741ad97d6683502286cc2655bb396ab5f4dfad12b8c39bd2a63'}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'group': None, 'materialized': 'seed', 'incremental_strategy': None, 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'packages': [], 'docs': {'show': True, 'node_color': None}, 'contract': {'enforced': False}, 'quote_columns': None, 'post-hook': [], 'pre-hook': []}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'group': None, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1686912748.830045, 'config_call_dict': {}, 'relation_name': '"postgres"."jaffle_shop"."raw_customers"', 'raw_code': '', 'root_path': '/Users/linhnguyen/Demos/my-demo-dbt-app/src/jaffle_shop', 'depends_on': {'macros': []}}, 'seed.jaffle_shop.raw_orders': {'database': 'postgres', 'schema': 'jaffle_shop', 'name': 'raw_orders', 'resource_type': 'seed', 'package_name': 'jaffle_shop', 'path': 'raw_orders.csv', 'original_file_path': 'seeds/raw_orders.csv', 'unique_id': 'seed.jaffle_shop.raw_orders', 'fqn': ['jaffle_shop', 'raw_orders'], 'alias': 'raw_orders', 'checksum': {'name': 'sha256', 'checksum': 'ddecd7adf70a07a88b9c302aec2a03fce615b925c2c06f2d5ef99a5c97b41250'}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'group': None, 'materialized': 'seed', 'incremental_strategy': None, 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'packages': [], 'docs': {'show': True, 'node_color': None}, 'contract': {'enforced': False}, 'quote_columns': None, 'post-hook': [], 'pre-hook': []}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'group': None, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1686912748.832164, 'config_call_dict': {}, 'relation_name': '"postgres"."jaffle_shop"."raw_orders"', 'raw_code': '', 'root_path': '/Users/linhnguyen/Demos/my-demo-dbt-app/src/jaffle_shop', 'depends_on': {'macros': []}}, 'seed.jaffle_shop.raw_payments': {'database': 'postgres', 'schema': 'jaffle_shop', 'name': 'raw_payments', 'resource_type': 'seed', 'package_name': 'jaffle_shop', 'path': 'raw_payments.csv', 'original_file_path': 'seeds/raw_payments.csv', 'unique_id': 'seed.jaffle_shop.raw_payments', 'fqn': ['jaffle_shop', 'raw_payments'], 'alias': 'raw_payments', 'checksum': {'name': 'sha256', 'checksum': '6de0626a8db9c1750eefd1b2e17fac4c2a4b9f778eb50532d8b377b90de395e6'}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'group': None, 'materialized': 'seed', 'incremental_strategy': None, 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'packages': [], 'docs': {'show': True, 'node_color': None}, 'contract': {'enforced': False}, 'quote_columns': None, 'post-hook': [], 'pre-hook': []}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'group': None, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1686912748.8337421, 'config_call_dict': {}, 'relation_name': '"postgres"."jaffle_shop"."raw_payments"', 'raw_code': '', 'root_path': '/Users/linhnguyen/Demos/my-demo-dbt-app/src/jaffle_shop', 'depends_on': {'macros': []}}, 'test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1': {'test_metadata': {'name': 'unique', 'kwargs': {'column_name': 'customer_id', 'model': "{{ get_where_subquery(ref('customers')) }}"}, 'namespace': None}, 'database': 'postgres', 'schema': 'jaffle_shop_dbt_test__audit', 'name': 'unique_customers_customer_id', 'resource_type': 'test', 'package_name': 'jaffle_shop', 'path': 'unique_customers_customer_id.sql', 'original_file_path': 'models/schema.yml', 'unique_id': 'test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1', 'fqn': ['jaffle_shop', 'unique_customers_customer_id'], 'alias': 'unique_customers_customer_id', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'group': None, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'group': None, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1686912748.859128, 'config_call_dict': {}, 'relation_name': None, 'raw_code': '{{ test_unique(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'refs': [{'name': 'customers', 'package': None, 'version': None}], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_unique'], 'nodes': ['model.jaffle_shop.customers']}, 'compiled_path': None, 'contract': {'enforced': False, 'checksum': None}, 'column_name': 'customer_id', 'file_key_name': 'models.customers', 'attached_node': 'model.jaffle_shop.customers'}, 'test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d': {'test_metadata': {'name': 'not_null', 'kwargs': {'column_name': 'customer_id', 'model': "{{ get_where_subquery(ref('customers')) }}"}, 'namespace': None}, 'database': 'postgres', 'schema': 'jaffle_shop_dbt_test__audit', 'name': 'not_null_customers_customer_id', 'resource_type': 'test', 'package_name': 'jaffle_shop', 'path': 'not_null_customers_customer_id.sql', 'original_file_path': 'models/schema.yml', 'unique_id': 'test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d', 'fqn': ['jaffle_shop', 'not_null_customers_customer_id'], 'alias': 'not_null_customers_customer_id', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'group': None, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'group': None, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1686912748.86031, 'config_call_dict': {}, 'relation_name': None, 'raw_code': '{{ test_not_null(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'refs': [{'name': 'customers', 'package': None, 'version': None}], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_not_null'], 'nodes': ['model.jaffle_shop.customers']}, 'compiled_path': None, 'contract': {'enforced': False, 'checksum': None}, 'column_name': 'customer_id', 'file_key_name': 'models.customers', 'attached_node': 'model.jaffle_shop.customers'}, 'test.jaffle_shop.unique_orders_order_id.fed79b3a6e': {'test_metadata': {'name': 'unique', 'kwargs': {'column_name': 'order_id', 'model': "{{ get_where_subquery(ref('orders')) }}"}, 'namespace': None}, 'database': 'postgres', 'schema': 'jaffle_shop_dbt_test__audit', 'name': 'unique_orders_order_id', 'resource_type': 'test', 'package_name': 'jaffle_shop', 'path': 'unique_orders_order_id.sql', 'original_file_path': 'models/schema.yml', 'unique_id': 'test.jaffle_shop.unique_orders_order_id.fed79b3a6e', 'fqn': ['jaffle_shop', 'unique_orders_order_id'], 'alias': 'unique_orders_order_id', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'group': None, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'group': None, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1686912748.861386, 'config_call_dict': {}, 'relation_name': None, 'raw_code': '{{ test_unique(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'refs': [{'name': 'orders', 'package': None, 'version': None}], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_unique'], 'nodes': ['model.jaffle_shop.orders']}, 'compiled_path': None, 'contract': {'enforced': False, 'checksum': None}, 'column_name': 'order_id', 'file_key_name': 'models.orders', 'attached_node': 'model.jaffle_shop.orders'}, 'test.jaffle_shop.not_null_orders_order_id.cf6c17daed': {'test_metadata': {'name': 'not_null', 'kwargs': {'column_name': 'order_id', 'model': "{{ get_where_subquery(ref('orders')) }}"}, 'namespace': None}, 'database': 'postgres', 'schema': 'jaffle_shop_dbt_test__audit', 'name': 'not_null_orders_order_id', 'resource_type': 'test', 'package_name': 'jaffle_shop', 'path': 'not_null_orders_order_id.sql', 'original_file_path': 'models/schema.yml', 'unique_id': 'test.jaffle_shop.not_null_orders_order_id.cf6c17daed', 'fqn': ['jaffle_shop', 'not_null_orders_order_id'], 'alias': 'not_null_orders_order_id', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'group': None, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'group': None, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1686912748.862985, 'config_call_dict': {}, 'relation_name': None, 'raw_code': '{{ test_not_null(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'refs': [{'name': 'orders', 'package': None, 'version': None}], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_not_null'], 'nodes': ['model.jaffle_shop.orders']}, 'compiled_path': None, 'contract': {'enforced': False, 'checksum': None}, 'column_name': 'order_id', 'file_key_name': 'models.orders', 'attached_node': 'model.jaffle_shop.orders'}, 'test.jaffle_shop.not_null_orders_customer_id.c5f02694af': {'test_metadata': {'name': 'not_null', 'kwargs': {'column_name': 'customer_id', 'model': "{{ get_where_subquery(ref('orders')) }}"}, 'namespace': None}, 'database': 'postgres', 'schema': 'jaffle_shop_dbt_test__audit', 'name': 'not_null_orders_customer_id', 'resource_type': 'test', 'package_name': 'jaffle_shop', 'path': 'not_null_orders_customer_id.sql', 'original_file_path': 'models/schema.yml', 'unique_id': 'test.jaffle_shop.not_null_orders_customer_id.c5f02694af', 'fqn': ['jaffle_shop', 'not_null_orders_customer_id'], 'alias': 'not_null_orders_customer_id', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'group': None, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'group': None, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1686912748.864012, 'config_call_dict': {}, 'relation_name': None, 'raw_code': '{{ test_not_null(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'refs': [{'name': 'orders', 'package': None, 'version': None}], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_not_null'], 'nodes': ['model.jaffle_shop.orders']}, 'compiled_path': None, 'contract': {'enforced': False, 'checksum': None}, 'column_name': 'customer_id', 'file_key_name': 'models.orders', 'attached_node': 'model.jaffle_shop.orders'}, 'test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2': {'test_metadata': {'name': 'relationships', 'kwargs': {'to': "ref('customers')", 'field': 'customer_id', 'column_name': 'customer_id', 'model': "{{ get_where_subquery(ref('orders')) }}"}, 'namespace': None}, 'database': 'postgres', 'schema': 'jaffle_shop_dbt_test__audit', 'name': 'relationships_orders_customer_id__customer_id__ref_customers_', 'resource_type': 'test', 'package_name': 'jaffle_shop', 'path': 'relationships_orders_customer_id__customer_id__ref_customers_.sql', 'original_file_path': 'models/schema.yml', 'unique_id': 'test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2', 'fqn': ['jaffle_shop', 'relationships_orders_customer_id__customer_id__ref_customers_'], 'alias': 'relationships_orders_customer_id__customer_id__ref_customers_', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'group': None, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'group': None, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1686912748.8650482, 'config_call_dict': {}, 'relation_name': None, 'raw_code': '{{ test_relationships(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'refs': [{'name': 'customers', 'package': None, 'version': None}, {'name': 'orders', 'package': None, 'version': None}], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_relationships', 'macro.dbt.get_where_subquery'], 'nodes': ['model.jaffle_shop.customers', 'model.jaffle_shop.orders']}, 'compiled_path': None, 'contract': {'enforced': False, 'checksum': None}, 'column_name': 'customer_id', 'file_key_name': 'models.orders', 'attached_node': 'model.jaffle_shop.orders'}, 'test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3': {'test_metadata': {'name': 'accepted_values', 'kwargs': {'values': ['placed', 'shipped', 'completed', 'return_pending', 'returned'], 'column_name': 'status', 'model': "{{ get_where_subquery(ref('orders')) }}"}, 'namespace': None}, 'database': 'postgres', 'schema': 'jaffle_shop_dbt_test__audit', 'name': 'accepted_values_orders_status__placed__shipped__completed__return_pending__returned', 'resource_type': 'test', 'package_name': 'jaffle_shop', 'path': 'accepted_values_orders_1ce6ab157c285f7cd2ac656013faf758.sql', 'original_file_path': 'models/schema.yml', 'unique_id': 'test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3', 'fqn': ['jaffle_shop', 'accepted_values_orders_status__placed__shipped__completed__return_pending__returned'], 'alias': 'accepted_values_orders_1ce6ab157c285f7cd2ac656013faf758', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': 'accepted_values_orders_1ce6ab157c285f7cd2ac656013faf758', 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'group': None, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'group': None, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'alias': 'accepted_values_orders_1ce6ab157c285f7cd2ac656013faf758'}, 'created_at': 1686912748.8707762, 'config_call_dict': {'alias': 'accepted_values_orders_1ce6ab157c285f7cd2ac656013faf758'}, 'relation_name': None, 'raw_code': '{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias="accepted_values_orders_1ce6ab157c285f7cd2ac656013faf758") }}', 'language': 'sql', 'refs': [{'name': 'orders', 'package': None, 'version': None}], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_accepted_values', 'macro.dbt.get_where_subquery'], 'nodes': ['model.jaffle_shop.orders']}, 'compiled_path': None, 'contract': {'enforced': False, 'checksum': None}, 'column_name': 'status', 'file_key_name': 'models.orders', 'attached_node': 'model.jaffle_shop.orders'}, 'test.jaffle_shop.not_null_orders_amount.106140f9fd': {'test_metadata': {'name': 'not_null', 'kwargs': {'column_name': 'amount', 'model': "{{ get_where_subquery(ref('orders')) }}"}, 'namespace': None}, 'database': 'postgres', 'schema': 'jaffle_shop_dbt_test__audit', 'name': 'not_null_orders_amount', 'resource_type': 'test', 'package_name': 'jaffle_shop', 'path': 'not_null_orders_amount.sql', 'original_file_path': 'models/schema.yml', 'unique_id': 'test.jaffle_shop.not_null_orders_amount.106140f9fd', 'fqn': ['jaffle_shop', 'not_null_orders_amount'], 'alias': 'not_null_orders_amount', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'group': None, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'group': None, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1686912748.876126, 'config_call_dict': {}, 'relation_name': None, 'raw_code': '{{ test_not_null(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'refs': [{'name': 'orders', 'package': None, 'version': None}], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_not_null'], 'nodes': ['model.jaffle_shop.orders']}, 'compiled_path': None, 'contract': {'enforced': False, 'checksum': None}, 'column_name': 'amount', 'file_key_name': 'models.orders', 'attached_node': 'model.jaffle_shop.orders'}, 'test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59': {'test_metadata': {'name': 'not_null', 'kwargs': {'column_name': 'credit_card_amount', 'model': "{{ get_where_subquery(ref('orders')) }}"}, 'namespace': None}, 'database': 'postgres', 'schema': 'jaffle_shop_dbt_test__audit', 'name': 'not_null_orders_credit_card_amount', 'resource_type': 'test', 'package_name': 'jaffle_shop', 'path': 'not_null_orders_credit_card_amount.sql', 'original_file_path': 'models/schema.yml', 'unique_id': 'test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59', 'fqn': ['jaffle_shop', 'not_null_orders_credit_card_amount'], 'alias': 'not_null_orders_credit_card_amount', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'group': None, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'group': None, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1686912748.877294, 'config_call_dict': {}, 'relation_name': None, 'raw_code': '{{ test_not_null(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'refs': [{'name': 'orders', 'package': None, 'version': None}], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_not_null'], 'nodes': ['model.jaffle_shop.orders']}, 'compiled_path': None, 'contract': {'enforced': False, 'checksum': None}, 'column_name': 'credit_card_amount', 'file_key_name': 'models.orders', 'attached_node': 'model.jaffle_shop.orders'}, 'test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625': {'test_metadata': {'name': 'not_null', 'kwargs': {'column_name': 'coupon_amount', 'model': "{{ get_where_subquery(ref('orders')) }}"}, 'namespace': None}, 'database': 'postgres', 'schema': 'jaffle_shop_dbt_test__audit', 'name': 'not_null_orders_coupon_amount', 'resource_type': 'test', 'package_name': 'jaffle_shop', 'path': 'not_null_orders_coupon_amount.sql', 'original_file_path': 'models/schema.yml', 'unique_id': 'test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625', 'fqn': ['jaffle_shop', 'not_null_orders_coupon_amount'], 'alias': 'not_null_orders_coupon_amount', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'group': None, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'group': None, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1686912748.878551, 'config_call_dict': {}, 'relation_name': None, 'raw_code': '{{ test_not_null(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'refs': [{'name': 'orders', 'package': None, 'version': None}], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_not_null'], 'nodes': ['model.jaffle_shop.orders']}, 'compiled_path': None, 'contract': {'enforced': False, 'checksum': None}, 'column_name': 'coupon_amount', 'file_key_name': 'models.orders', 'attached_node': 'model.jaffle_shop.orders'}, 'test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49': {'test_metadata': {'name': 'not_null', 'kwargs': {'column_name': 'bank_transfer_amount', 'model': "{{ get_where_subquery(ref('orders')) }}"}, 'namespace': None}, 'database': 'postgres', 'schema': 'jaffle_shop_dbt_test__audit', 'name': 'not_null_orders_bank_transfer_amount', 'resource_type': 'test', 'package_name': 'jaffle_shop', 'path': 'not_null_orders_bank_transfer_amount.sql', 'original_file_path': 'models/schema.yml', 'unique_id': 'test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49', 'fqn': ['jaffle_shop', 'not_null_orders_bank_transfer_amount'], 'alias': 'not_null_orders_bank_transfer_amount', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'group': None, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'group': None, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1686912748.8798091, 'config_call_dict': {}, 'relation_name': None, 'raw_code': '{{ test_not_null(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'refs': [{'name': 'orders', 'package': None, 'version': None}], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_not_null'], 'nodes': ['model.jaffle_shop.orders']}, 'compiled_path': None, 'contract': {'enforced': False, 'checksum': None}, 'column_name': 'bank_transfer_amount', 'file_key_name': 'models.orders', 'attached_node': 'model.jaffle_shop.orders'}, 'test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a': {'test_metadata': {'name': 'not_null', 'kwargs': {'column_name': 'gift_card_amount', 'model': "{{ get_where_subquery(ref('orders')) }}"}, 'namespace': None}, 'database': 'postgres', 'schema': 'jaffle_shop_dbt_test__audit', 'name': 'not_null_orders_gift_card_amount', 'resource_type': 'test', 'package_name': 'jaffle_shop', 'path': 'not_null_orders_gift_card_amount.sql', 'original_file_path': 'models/schema.yml', 'unique_id': 'test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a', 'fqn': ['jaffle_shop', 'not_null_orders_gift_card_amount'], 'alias': 'not_null_orders_gift_card_amount', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'group': None, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'group': None, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1686912748.880893, 'config_call_dict': {}, 'relation_name': None, 'raw_code': '{{ test_not_null(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'refs': [{'name': 'orders', 'package': None, 'version': None}], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_not_null'], 'nodes': ['model.jaffle_shop.orders']}, 'compiled_path': None, 'contract': {'enforced': False, 'checksum': None}, 'column_name': 'gift_card_amount', 'file_key_name': 'models.orders', 'attached_node': 'model.jaffle_shop.orders'}, 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada': {'test_metadata': {'name': 'unique', 'kwargs': {'column_name': 'customer_id', 'model': "{{ get_where_subquery(ref('stg_customers')) }}"}, 'namespace': None}, 'database': 'postgres', 'schema': 'jaffle_shop_dbt_test__audit', 'name': 'unique_stg_customers_customer_id', 'resource_type': 'test', 'package_name': 'jaffle_shop', 'path': 'unique_stg_customers_customer_id.sql', 'original_file_path': 'models/staging/schema.yml', 'unique_id': 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada', 'fqn': ['jaffle_shop', 'staging', 'unique_stg_customers_customer_id'], 'alias': 'unique_stg_customers_customer_id', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'group': None, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'group': None, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1686912748.883935, 'config_call_dict': {}, 'relation_name': None, 'raw_code': '{{ test_unique(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'refs': [{'name': 'stg_customers', 'package': None, 'version': None}], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_unique'], 'nodes': ['model.jaffle_shop.stg_customers']}, 'compiled_path': None, 'contract': {'enforced': False, 'checksum': None}, 'column_name': 'customer_id', 'file_key_name': 'models.stg_customers', 'attached_node': 'model.jaffle_shop.stg_customers'}, 'test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa': {'test_metadata': {'name': 'not_null', 'kwargs': {'column_name': 'customer_id', 'model': "{{ get_where_subquery(ref('stg_customers')) }}"}, 'namespace': None}, 'database': 'postgres', 'schema': 'jaffle_shop_dbt_test__audit', 'name': 'not_null_stg_customers_customer_id', 'resource_type': 'test', 'package_name': 'jaffle_shop', 'path': 'not_null_stg_customers_customer_id.sql', 'original_file_path': 'models/staging/schema.yml', 'unique_id': 'test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa', 'fqn': ['jaffle_shop', 'staging', 'not_null_stg_customers_customer_id'], 'alias': 'not_null_stg_customers_customer_id', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'group': None, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'group': None, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1686912748.885078, 'config_call_dict': {}, 'relation_name': None, 'raw_code': '{{ test_not_null(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'refs': [{'name': 'stg_customers', 'package': None, 'version': None}], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_not_null'], 'nodes': ['model.jaffle_shop.stg_customers']}, 'compiled_path': None, 'contract': {'enforced': False, 'checksum': None}, 'column_name': 'customer_id', 'file_key_name': 'models.stg_customers', 'attached_node': 'model.jaffle_shop.stg_customers'}, 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a': {'test_metadata': {'name': 'unique', 'kwargs': {'column_name': 'order_id', 'model': "{{ get_where_subquery(ref('stg_orders')) }}"}, 'namespace': None}, 'database': 'postgres', 'schema': 'jaffle_shop_dbt_test__audit', 'name': 'unique_stg_orders_order_id', 'resource_type': 'test', 'package_name': 'jaffle_shop', 'path': 'unique_stg_orders_order_id.sql', 'original_file_path': 'models/staging/schema.yml', 'unique_id': 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a', 'fqn': ['jaffle_shop', 'staging', 'unique_stg_orders_order_id'], 'alias': 'unique_stg_orders_order_id', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'group': None, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'group': None, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1686912748.886181, 'config_call_dict': {}, 'relation_name': None, 'raw_code': '{{ test_unique(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'refs': [{'name': 'stg_orders', 'package': None, 'version': None}], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_unique'], 'nodes': ['model.jaffle_shop.stg_orders']}, 'compiled_path': None, 'contract': {'enforced': False, 'checksum': None}, 'column_name': 'order_id', 'file_key_name': 'models.stg_orders', 'attached_node': 'model.jaffle_shop.stg_orders'}, 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64': {'test_metadata': {'name': 'not_null', 'kwargs': {'column_name': 'order_id', 'model': "{{ get_where_subquery(ref('stg_orders')) }}"}, 'namespace': None}, 'database': 'postgres', 'schema': 'jaffle_shop_dbt_test__audit', 'name': 'not_null_stg_orders_order_id', 'resource_type': 'test', 'package_name': 'jaffle_shop', 'path': 'not_null_stg_orders_order_id.sql', 'original_file_path': 'models/staging/schema.yml', 'unique_id': 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64', 'fqn': ['jaffle_shop', 'staging', 'not_null_stg_orders_order_id'], 'alias': 'not_null_stg_orders_order_id', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'group': None, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'group': None, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1686912748.887425, 'config_call_dict': {}, 'relation_name': None, 'raw_code': '{{ test_not_null(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'refs': [{'name': 'stg_orders', 'package': None, 'version': None}], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_not_null'], 'nodes': ['model.jaffle_shop.stg_orders']}, 'compiled_path': None, 'contract': {'enforced': False, 'checksum': None}, 'column_name': 'order_id', 'file_key_name': 'models.stg_orders', 'attached_node': 'model.jaffle_shop.stg_orders'}, 'test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad': {'test_metadata': {'name': 'accepted_values', 'kwargs': {'values': ['placed', 'shipped', 'completed', 'return_pending', 'returned'], 'column_name': 'status', 'model': "{{ get_where_subquery(ref('stg_orders')) }}"}, 'namespace': None}, 'database': 'postgres', 'schema': 'jaffle_shop_dbt_test__audit', 'name': 'accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned', 'resource_type': 'test', 'package_name': 'jaffle_shop', 'path': 'accepted_values_stg_orders_4f514bf94b77b7ea437830eec4421c58.sql', 'original_file_path': 'models/staging/schema.yml', 'unique_id': 'test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad', 'fqn': ['jaffle_shop', 'staging', 'accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned'], 'alias': 'accepted_values_stg_orders_4f514bf94b77b7ea437830eec4421c58', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': 'accepted_values_stg_orders_4f514bf94b77b7ea437830eec4421c58', 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'group': None, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'group': None, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'alias': 'accepted_values_stg_orders_4f514bf94b77b7ea437830eec4421c58'}, 'created_at': 1686912748.888573, 'config_call_dict': {'alias': 'accepted_values_stg_orders_4f514bf94b77b7ea437830eec4421c58'}, 'relation_name': None, 'raw_code': '{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias="accepted_values_stg_orders_4f514bf94b77b7ea437830eec4421c58") }}', 'language': 'sql', 'refs': [{'name': 'stg_orders', 'package': None, 'version': None}], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_accepted_values', 'macro.dbt.get_where_subquery'], 'nodes': ['model.jaffle_shop.stg_orders']}, 'compiled_path': None, 'contract': {'enforced': False, 'checksum': None}, 'column_name': 'status', 'file_key_name': 'models.stg_orders', 'attached_node': 'model.jaffle_shop.stg_orders'}, 'test.jaffle_shop.unique_stg_payments_payment_id.3744510712': {'test_metadata': {'name': 'unique', 'kwargs': {'column_name': 'payment_id', 'model': "{{ get_where_subquery(ref('stg_payments')) }}"}, 'namespace': None}, 'database': 'postgres', 'schema': 'jaffle_shop_dbt_test__audit', 'name': 'unique_stg_payments_payment_id', 'resource_type': 'test', 'package_name': 'jaffle_shop', 'path': 'unique_stg_payments_payment_id.sql', 'original_file_path': 'models/staging/schema.yml', 'unique_id': 'test.jaffle_shop.unique_stg_payments_payment_id.3744510712', 'fqn': ['jaffle_shop', 'staging', 'unique_stg_payments_payment_id'], 'alias': 'unique_stg_payments_payment_id', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'group': None, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'group': None, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1686912748.891718, 'config_call_dict': {}, 'relation_name': None, 'raw_code': '{{ test_unique(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'refs': [{'name': 'stg_payments', 'package': None, 'version': None}], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_unique'], 'nodes': ['model.jaffle_shop.stg_payments']}, 'compiled_path': None, 'contract': {'enforced': False, 'checksum': None}, 'column_name': 'payment_id', 'file_key_name': 'models.stg_payments', 'attached_node': 'model.jaffle_shop.stg_payments'}, 'test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075': {'test_metadata': {'name': 'not_null', 'kwargs': {'column_name': 'payment_id', 'model': "{{ get_where_subquery(ref('stg_payments')) }}"}, 'namespace': None}, 'database': 'postgres', 'schema': 'jaffle_shop_dbt_test__audit', 'name': 'not_null_stg_payments_payment_id', 'resource_type': 'test', 'package_name': 'jaffle_shop', 'path': 'not_null_stg_payments_payment_id.sql', 'original_file_path': 'models/staging/schema.yml', 'unique_id': 'test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075', 'fqn': ['jaffle_shop', 'staging', 'not_null_stg_payments_payment_id'], 'alias': 'not_null_stg_payments_payment_id', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'group': None, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'group': None, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1686912748.8927948, 'config_call_dict': {}, 'relation_name': None, 'raw_code': '{{ test_not_null(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'refs': [{'name': 'stg_payments', 'package': None, 'version': None}], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_not_null'], 'nodes': ['model.jaffle_shop.stg_payments']}, 'compiled_path': None, 'contract': {'enforced': False, 'checksum': None}, 'column_name': 'payment_id', 'file_key_name': 'models.stg_payments', 'attached_node': 'model.jaffle_shop.stg_payments'}, 'test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278': {'test_metadata': {'name': 'accepted_values', 'kwargs': {'values': ['credit_card', 'coupon', 'bank_transfer', 'gift_card'], 'column_name': 'payment_method', 'model': "{{ get_where_subquery(ref('stg_payments')) }}"}, 'namespace': None}, 'database': 'postgres', 'schema': 'jaffle_shop_dbt_test__audit', 'name': 'accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card', 'resource_type': 'test', 'package_name': 'jaffle_shop', 'path': 'accepted_values_stg_payments_c7909fb19b1f0177c2bf99c7912f06ef.sql', 'original_file_path': 'models/staging/schema.yml', 'unique_id': 'test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278', 'fqn': ['jaffle_shop', 'staging', 'accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card'], 'alias': 'accepted_values_stg_payments_c7909fb19b1f0177c2bf99c7912f06ef', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': 'accepted_values_stg_payments_c7909fb19b1f0177c2bf99c7912f06ef', 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'group': None, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'group': None, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'alias': 'accepted_values_stg_payments_c7909fb19b1f0177c2bf99c7912f06ef'}, 'created_at': 1686912748.894026, 'config_call_dict': {'alias': 'accepted_values_stg_payments_c7909fb19b1f0177c2bf99c7912f06ef'}, 'relation_name': None, 'raw_code': '{{ test_accepted_values(**_dbt_generic_test_kwargs) }}{{ config(alias="accepted_values_stg_payments_c7909fb19b1f0177c2bf99c7912f06ef") }}', 'language': 'sql', 'refs': [{'name': 'stg_payments', 'package': None, 'version': None}], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_accepted_values', 'macro.dbt.get_where_subquery'], 'nodes': ['model.jaffle_shop.stg_payments']}, 'compiled_path': None, 'contract': {'enforced': False, 'checksum': None}, 'column_name': 'payment_method', 'file_key_name': 'models.stg_payments', 'attached_node': 'model.jaffle_shop.stg_payments'}}
[0m10:53:21.356946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8a4694c5-0e4e-4280-bf67-5f9d6be4e0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb69ba9b0>]}
[0m10:53:21.434840 [debug] [MainThread]: Parsing macros/adapters.sql
[0m10:53:21.446545 [debug] [MainThread]: Parsing macros/relations.sql
[0m10:53:21.447882 [debug] [MainThread]: Parsing macros/catalog.sql
[0m10:53:21.449459 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m10:53:21.450862 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m10:53:21.452117 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m10:53:21.455390 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m10:53:21.456269 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m10:53:21.457310 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m10:53:21.458050 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m10:53:21.459079 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m10:53:21.460248 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m10:53:21.461190 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m10:53:21.462368 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m10:53:21.463432 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m10:53:21.464877 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m10:53:21.465791 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m10:53:21.466732 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m10:53:21.467783 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m10:53:21.468673 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m10:53:21.469711 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m10:53:21.470633 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m10:53:21.472218 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m10:53:21.473111 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m10:53:21.474130 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m10:53:21.475248 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m10:53:21.476110 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m10:53:21.477118 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m10:53:21.477971 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m10:53:21.478908 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m10:53:21.480001 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m10:53:21.481189 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m10:53:21.482171 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m10:53:21.483064 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m10:53:21.484362 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m10:53:21.487556 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m10:53:21.488504 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m10:53:21.489511 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m10:53:21.490386 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m10:53:21.491313 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m10:53:21.493312 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m10:53:21.494702 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m10:53:21.495907 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m10:53:21.497153 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m10:53:21.499865 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m10:53:21.507099 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m10:53:21.508280 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m10:53:21.516225 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m10:53:21.519914 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m10:53:21.523612 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m10:53:21.529179 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m10:53:21.530277 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m10:53:21.533047 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m10:53:21.534503 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m10:53:21.537761 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m10:53:21.541102 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m10:53:21.543236 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m10:53:21.549432 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m10:53:21.550697 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m10:53:21.557704 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m10:53:21.563163 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m10:53:21.571982 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m10:53:21.575350 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m10:53:21.579924 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m10:53:21.582591 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m10:53:21.583432 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m10:53:21.584362 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m10:53:21.585245 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m10:53:21.586361 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m10:53:21.589289 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m10:53:21.590852 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m10:53:21.595155 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m10:53:21.601064 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m10:53:21.602554 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m10:53:21.603995 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m10:53:21.607758 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m10:53:21.610073 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m10:53:21.616736 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m10:53:21.618584 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m10:53:21.620362 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m10:53:21.621875 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m10:53:21.623205 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m10:53:21.624541 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m10:53:21.626912 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m10:53:21.628974 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m10:53:21.630265 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m10:53:21.632693 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m10:53:21.637269 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m10:53:21.638706 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m10:53:21.640147 [debug] [MainThread]: Parsing macros/generic_tests/not_empty_string.sql
[0m10:53:21.641422 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m10:53:21.643316 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m10:53:21.645274 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m10:53:21.646788 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m10:53:21.649140 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m10:53:21.651102 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
[0m10:53:21.652383 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
[0m10:53:21.653528 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m10:53:21.654539 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m10:53:21.655470 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m10:53:21.656565 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m10:53:21.657658 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m10:53:21.660249 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m10:53:21.662312 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m10:53:21.664625 [debug] [MainThread]: Parsing macros/sql/generate_surrogate_key.sql
[0m10:53:21.666216 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m10:53:21.668910 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m10:53:21.670593 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m10:53:21.672216 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m10:53:21.674261 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m10:53:21.676182 [debug] [MainThread]: Parsing macros/sql/get_single_value.sql
[0m10:53:21.677866 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m10:53:21.679141 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m10:53:21.682385 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m10:53:21.683546 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m10:53:21.684671 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m10:53:21.687595 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m10:53:21.688845 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m10:53:21.689999 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m10:53:21.692177 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m10:53:21.693619 [debug] [MainThread]: Parsing macros/sql/safe_divide.sql
[0m10:53:21.694534 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m10:53:21.697340 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m10:53:21.698488 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m10:53:21.704609 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m10:53:21.707635 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
[0m10:53:21.710310 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m10:53:21.711749 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m10:53:21.713013 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m10:53:21.851784 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m10:53:21.858522 [debug] [MainThread]: 1603: static parser failed on orders.sql
[0m10:53:21.861659 [debug] [MainThread]: 1602: parser fallback to jinja rendering on orders.sql
[0m10:53:21.862820 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customers.sql
[0m10:53:21.864544 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_orders.sql
[0m10:53:21.866247 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_payments.sql
[0m10:53:21.986954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a4694c5-0e4e-4280-bf67-5f9d6be4e0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb68bb790>]}
[0m10:53:22.001456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a4694c5-0e4e-4280-bf67-5f9d6be4e0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5d1a350>]}
[0m10:53:22.002171 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:53:22.003045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a4694c5-0e4e-4280-bf67-5f9d6be4e0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5cfc610>]}
[0m10:53:22.004588 [info ] [MainThread]: 
[0m10:53:22.005353 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:53:22.006512 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m10:53:22.012823 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:53:22.013348 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:53:22.013787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:37.184366 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "postgres" (125.235.4.59), port 5432 failed: timeout expired



============================== 2023-06-16 11:00:08.240689 | 7f4cb468-a7e2-4e87-b53b-76efde66387c ==============================
[0m11:00:08.240697 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:00:08.241380 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m11:00:08.242050 [debug] [MainThread]: Tracking: tracking
[0m11:00:08.244070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2547eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2546530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2544bb0>]}
[0m11:00:08.245385 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-i0odaxh5'
[0m11:00:08.245977 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:00:08.551696 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:00:08.554168 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:00:08.674434 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:00:08.708719 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m11:00:09.959814 [info ] [MainThread]:   Installed from version 1.0.0
[0m11:00:09.960496 [info ] [MainThread]:   Updated version available: 1.1.1
[0m11:00:09.961233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7f4cb468-a7e2-4e87-b53b-76efde66387c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2547ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa25460b0>]}
[0m11:00:09.963163 [info ] [MainThread]: 
[0m11:00:09.963793 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m11:00:09.964669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa255dab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa25447f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2544df0>]}
[0m11:00:09.965716 [debug] [MainThread]: Flushing usage events


============================== 2023-06-16 11:00:12.420614 | c831aab1-1bca-49a4-b878-614ce38eeb6a ==============================
[0m11:00:12.420622 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:00:12.421488 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/jaffle_shop/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m11:00:12.422124 [debug] [MainThread]: Tracking: tracking
[0m11:00:12.423773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cff7940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cff7850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cff78b0>]}
[0m11:00:12.530702 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:00:12.531434 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:00:12.536318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c831aab1-1bca-49a4-b878-614ce38eeb6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c464340>]}
[0m11:00:12.549516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c831aab1-1bca-49a4-b878-614ce38eeb6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c426fb0>]}
[0m11:00:12.550226 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:00:12.550863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c831aab1-1bca-49a4-b878-614ce38eeb6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c427010>]}
[0m11:00:12.552184 [info ] [MainThread]: 
[0m11:00:12.552886 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:00:12.553910 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m11:00:12.559855 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:00:12.560467 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:00:12.561104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:00:12.562849 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "postgres" (10.104.177.126), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m11:00:12.563972 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:00:12.564590 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m11:00:12.565210 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m11:00:12.565705 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m11:00:12.566209 [debug] [ThreadPool]: On list_postgres: No close available on handle
[0m11:00:12.567168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:00:12.567738 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m11:00:12.568197 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "postgres" (10.104.177.126), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m11:00:12.568954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c427010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c2a4850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c2a48b0>]}
[0m11:00:12.569508 [debug] [MainThread]: Flushing usage events


============================== 2023-06-16 11:00:18.538279 | 5d6cd279-ac7c-4666-8a46-981d5504823c ==============================
[0m11:00:18.538287 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:00:18.538950 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m11:00:18.539595 [debug] [MainThread]: Tracking: tracking
[0m11:00:18.541612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaa67ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaa664d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaa64b50>]}
[0m11:00:18.542702 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qe5wcog3'
[0m11:00:18.543252 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:00:18.668096 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:00:18.669960 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:00:18.815661 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:00:18.842226 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m11:00:20.097653 [info ] [MainThread]:   Installed from version 1.0.0
[0m11:00:20.098354 [info ] [MainThread]:   Updated version available: 1.1.1
[0m11:00:20.099000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5d6cd279-ac7c-4666-8a46-981d5504823c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaa67a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaa66050>]}
[0m11:00:20.099650 [info ] [MainThread]: 
[0m11:00:20.100231 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m11:00:20.101099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaa7da80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaa64880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaa67490>]}
[0m11:00:20.101676 [debug] [MainThread]: Flushing usage events


============================== 2023-06-16 11:00:22.476129 | 113735c3-7e71-4de7-88a3-f14c46d10899 ==============================
[0m11:00:22.476137 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:00:22.476596 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/jaffle_shop/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m11:00:22.477201 [debug] [MainThread]: Tracking: tracking
[0m11:00:22.479366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff985cb940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff985cb850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff985cb8b0>]}
[0m11:00:22.672964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:00:22.673608 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:00:22.677765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '113735c3-7e71-4de7-88a3-f14c46d10899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97a34310>]}
[0m11:00:22.688669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '113735c3-7e71-4de7-88a3-f14c46d10899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff979f2f80>]}
[0m11:00:22.689236 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:00:22.689721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '113735c3-7e71-4de7-88a3-f14c46d10899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff979f2fe0>]}
[0m11:00:22.690989 [info ] [MainThread]: 
[0m11:00:22.691658 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:00:22.692709 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m11:00:22.698438 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:00:22.698923 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:00:22.699342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:00:22.745747 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.05 seconds
[0m11:00:22.748221 [debug] [ThreadPool]: On list_postgres: Close
[0m11:00:22.750159 [debug] [ThreadPool]: Acquiring new postgres connection "create_postgres_jaffle_shop"
[0m11:00:22.752231 [debug] [ThreadPool]: Acquiring new postgres connection "create_postgres_jaffle_shop"
[0m11:00:22.752933 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='postgres', schema='jaffle_shop', identifier=None)"
[0m11:00:22.756288 [debug] [ThreadPool]: Using postgres connection "create_postgres_jaffle_shop"
[0m11:00:22.756885 [debug] [ThreadPool]: On create_postgres_jaffle_shop: BEGIN
[0m11:00:22.757566 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:00:22.780840 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m11:00:22.781568 [debug] [ThreadPool]: Using postgres connection "create_postgres_jaffle_shop"
[0m11:00:22.782187 [debug] [ThreadPool]: On create_postgres_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_postgres_jaffle_shop"} */
create schema if not exists "jaffle_shop"
[0m11:00:22.789706 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.01 seconds
[0m11:00:22.790711 [debug] [ThreadPool]: On create_postgres_jaffle_shop: COMMIT
[0m11:00:22.791290 [debug] [ThreadPool]: Using postgres connection "create_postgres_jaffle_shop"
[0m11:00:22.791891 [debug] [ThreadPool]: On create_postgres_jaffle_shop: COMMIT
[0m11:00:22.795175 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m11:00:22.795645 [debug] [ThreadPool]: On create_postgres_jaffle_shop: Close
[0m11:00:22.797050 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_jaffle_shop"
[0m11:00:22.800367 [debug] [ThreadPool]: Using postgres connection "list_postgres_jaffle_shop"
[0m11:00:22.801083 [debug] [ThreadPool]: On list_postgres_jaffle_shop: BEGIN
[0m11:00:22.801545 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:00:22.824379 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m11:00:22.825082 [debug] [ThreadPool]: Using postgres connection "list_postgres_jaffle_shop"
[0m11:00:22.825654 [debug] [ThreadPool]: On list_postgres_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres_jaffle_shop"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'jaffle_shop'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'jaffle_shop'
  
[0m11:00:22.866176 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.04 seconds
[0m11:00:22.867462 [debug] [ThreadPool]: On list_postgres_jaffle_shop: ROLLBACK
[0m11:00:22.868581 [debug] [ThreadPool]: On list_postgres_jaffle_shop: Close
[0m11:00:22.871792 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:22.872507 [debug] [MainThread]: On master: BEGIN
[0m11:00:22.873220 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:00:22.895250 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m11:00:22.896004 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:22.896782 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:00:22.969773 [debug] [MainThread]: SQL status: SELECT 43 in 0.07 seconds
[0m11:00:22.972164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '113735c3-7e71-4de7-88a3-f14c46d10899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9778be50>]}
[0m11:00:22.973311 [debug] [MainThread]: On master: ROLLBACK
[0m11:00:22.975296 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:22.975932 [debug] [MainThread]: On master: BEGIN
[0m11:00:22.976841 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:00:22.977476 [debug] [MainThread]: On master: COMMIT
[0m11:00:22.978153 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:22.978768 [debug] [MainThread]: On master: COMMIT
[0m11:00:22.979567 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:00:22.980172 [debug] [MainThread]: On master: Close
[0m11:00:22.981034 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:00:22.981720 [info ] [MainThread]: 
[0m11:00:22.990373 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m11:00:22.991124 [info ] [Thread-1 (]: 1 of 28 START seed file jaffle_shop.raw_customers .............................. [RUN]
[0m11:00:22.991879 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.jaffle_shop.raw_customers"
[0m11:00:22.992485 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m11:00:22.993070 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:22.993633 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m11:00:23.010365 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m11:00:23.011011 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: BEGIN
[0m11:00:23.011600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:28.076692 [debug] [Thread-1 (]: SQL status: BEGIN in 5.06 seconds
[0m11:00:28.080136 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m11:00:28.081117 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */

    create table "postgres"."jaffle_shop"."raw_customers" ("id" integer,"first_name" text,"last_name" text)
  
[0m11:00:28.107949 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.03 seconds
[0m11:00:28.147277 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m11:00:28.148120 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: 
          insert into "postgres"."jaffle_shop"."raw_customers" ("id", "first_name", "last_name") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(...
[0m11:00:28.159394 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.01 seconds
[0m11:00:28.163197 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m11:00:28.175709 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: COMMIT
[0m11:00:28.176354 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m11:00:28.176932 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: COMMIT
[0m11:00:28.179497 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:00:28.180244 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:28.180718 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m11:00:28.181573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '113735c3-7e71-4de7-88a3-f14c46d10899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff977d6a40>]}
[0m11:00:28.182199 [info ] [Thread-1 (]: 1 of 28 OK loaded seed file jaffle_shop.raw_customers .......................... [[32mINSERT 100[0m in 5.19s]
[0m11:00:28.183081 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m11:00:28.183596 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_orders
[0m11:00:28.184250 [info ] [Thread-1 (]: 2 of 28 START seed file jaffle_shop.raw_orders ................................. [RUN]
[0m11:00:28.184958 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.jaffle_shop.raw_orders"
[0m11:00:28.185401 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m11:00:28.185825 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:28.186263 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_orders
[0m11:00:28.190730 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m11:00:28.191360 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: BEGIN
[0m11:00:28.191947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:28.215532 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m11:00:28.216135 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m11:00:28.216676 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */

    create table "postgres"."jaffle_shop"."raw_orders" ("id" integer,"user_id" integer,"order_date" date,"status" text)
  
[0m11:00:28.235978 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.02 seconds
[0m11:00:28.273634 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m11:00:28.274277 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: 
          insert into "postgres"."jaffle_shop"."raw_orders" ("id", "user_id", "order_date", "status") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m11:00:28.287114 [debug] [Thread-1 (]: SQL status: INSERT 0 99 in 0.01 seconds
[0m11:00:28.288101 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m11:00:28.291143 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: COMMIT
[0m11:00:28.291778 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m11:00:28.292334 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: COMMIT
[0m11:00:28.294625 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:00:28.295292 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:28.295820 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: Close
[0m11:00:28.296520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '113735c3-7e71-4de7-88a3-f14c46d10899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9778ab30>]}
[0m11:00:28.297087 [info ] [Thread-1 (]: 2 of 28 OK loaded seed file jaffle_shop.raw_orders ............................. [[32mINSERT 99[0m in 0.11s]
[0m11:00:28.297660 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_orders
[0m11:00:28.298138 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_payments
[0m11:00:28.298697 [info ] [Thread-1 (]: 3 of 28 START seed file jaffle_shop.raw_payments ............................... [RUN]
[0m11:00:28.299424 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.jaffle_shop.raw_payments"
[0m11:00:28.299991 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m11:00:28.300536 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:28.301113 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_payments
[0m11:00:28.305973 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_payments"
[0m11:00:28.306867 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_payments: BEGIN
[0m11:00:28.307513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:28.329578 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m11:00:28.330284 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_payments"
[0m11:00:28.330862 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */

    create table "postgres"."jaffle_shop"."raw_payments" ("id" integer,"order_id" integer,"payment_method" text,"amount" integer)
  
[0m11:00:28.352080 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.02 seconds
[0m11:00:28.413628 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_payments"
[0m11:00:28.414646 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_payments: 
          insert into "postgres"."jaffle_shop"."raw_payments" ("id", "order_id", "payment_method", "amount") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,...
[0m11:00:28.426194 [debug] [Thread-1 (]: SQL status: INSERT 0 113 in 0.01 seconds
[0m11:00:28.427155 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m11:00:28.430350 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_payments: COMMIT
[0m11:00:28.430974 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_payments"
[0m11:00:28.431535 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_payments: COMMIT
[0m11:00:28.433929 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:00:28.434537 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:28.434998 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_payments: Close
[0m11:00:28.435688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '113735c3-7e71-4de7-88a3-f14c46d10899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a3a8130>]}
[0m11:00:28.436201 [info ] [Thread-1 (]: 3 of 28 OK loaded seed file jaffle_shop.raw_payments ........................... [[32mINSERT 113[0m in 0.14s]
[0m11:00:28.436771 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_payments
[0m11:00:28.437255 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m11:00:28.437730 [info ] [Thread-1 (]: 4 of 28 START sql view model jaffle_shop.stg_customers ......................... [RUN]
[0m11:00:28.438418 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.stg_customers"
[0m11:00:28.438882 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m11:00:28.439378 [debug] [Thread-1 (]: Compiling model.jaffle_shop.stg_customers
[0m11:00:28.441300 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m11:00:28.443340 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:28.443861 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m11:00:28.458962 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m11:00:28.461551 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:00:28.462178 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m11:00:28.462760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:28.485996 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m11:00:28.487009 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:00:28.487768 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "postgres"."jaffle_shop"."stg_customers__dbt_tmp" as (
    with source as (
    select * from "postgres"."jaffle_shop"."raw_customers"

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name

    from source

)

select * from renamed
  );
[0m11:00:28.511429 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.02 seconds
[0m11:00:28.515904 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:00:28.516635 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "postgres"."jaffle_shop"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m11:00:28.519202 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:00:28.520431 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m11:00:28.521093 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:00:28.521652 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m11:00:28.524238 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:00:28.527612 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:00:28.528094 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "postgres"."jaffle_shop"."stg_customers__dbt_backup" cascade
[0m11:00:28.529260 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:00:28.530140 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:28.530590 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m11:00:28.531301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '113735c3-7e71-4de7-88a3-f14c46d10899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9868f4f0>]}
[0m11:00:28.531998 [info ] [Thread-1 (]: 4 of 28 OK created sql view model jaffle_shop.stg_customers .................... [[32mCREATE VIEW[0m in 0.09s]
[0m11:00:28.532704 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m11:00:28.533278 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m11:00:28.533874 [info ] [Thread-1 (]: 5 of 28 START sql view model jaffle_shop.stg_orders ............................ [RUN]
[0m11:00:28.534684 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.stg_orders"
[0m11:00:28.535233 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m11:00:28.535754 [debug] [Thread-1 (]: Compiling model.jaffle_shop.stg_orders
[0m11:00:28.537641 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m11:00:28.539660 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:28.540157 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m11:00:28.542778 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m11:00:28.544798 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:00:28.545273 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m11:00:28.545705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:28.567275 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m11:00:28.567914 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:00:28.568689 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "postgres"."jaffle_shop"."stg_orders__dbt_tmp" as (
    with source as (
    select * from "postgres"."jaffle_shop"."raw_orders"

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed
  );
[0m11:00:28.591835 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.02 seconds
[0m11:00:28.593991 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:00:28.594636 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "postgres"."jaffle_shop"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m11:00:28.597407 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:00:28.598832 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m11:00:28.599497 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:00:28.600044 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m11:00:28.602605 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:00:28.604118 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:00:28.604751 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "postgres"."jaffle_shop"."stg_orders__dbt_backup" cascade
[0m11:00:28.605985 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:00:28.607002 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:28.607576 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: Close
[0m11:00:28.608286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '113735c3-7e71-4de7-88a3-f14c46d10899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9856b580>]}
[0m11:00:28.608912 [info ] [Thread-1 (]: 5 of 28 OK created sql view model jaffle_shop.stg_orders ....................... [[32mCREATE VIEW[0m in 0.07s]
[0m11:00:28.609604 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m11:00:28.610100 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m11:00:28.610692 [info ] [Thread-1 (]: 6 of 28 START sql view model jaffle_shop.stg_payments .......................... [RUN]
[0m11:00:28.611454 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.stg_payments"
[0m11:00:28.612082 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m11:00:28.612668 [debug] [Thread-1 (]: Compiling model.jaffle_shop.stg_payments
[0m11:00:28.614552 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m11:00:28.616556 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:28.617146 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m11:00:28.620248 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m11:00:28.621826 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:00:28.622317 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m11:00:28.622752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:28.648941 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:00:28.649771 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:00:28.650414 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "postgres"."jaffle_shop"."stg_payments__dbt_tmp" as (
    with source as (
    select * from "postgres"."jaffle_shop"."raw_payments"

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        -- `amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );
[0m11:00:28.674863 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.02 seconds
[0m11:00:28.676994 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:00:28.677580 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "postgres"."jaffle_shop"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m11:00:28.680556 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:00:28.681834 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m11:00:28.682422 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:00:28.683024 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m11:00:28.685346 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:00:28.686689 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:00:28.687168 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "postgres"."jaffle_shop"."stg_payments__dbt_backup" cascade
[0m11:00:28.688326 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:00:28.689182 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:28.689729 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: Close
[0m11:00:28.690446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '113735c3-7e71-4de7-88a3-f14c46d10899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a5b2710>]}
[0m11:00:28.691117 [info ] [Thread-1 (]: 6 of 28 OK created sql view model jaffle_shop.stg_payments ..................... [[32mCREATE VIEW[0m in 0.08s]
[0m11:00:28.691786 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m11:00:28.692358 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m11:00:28.692867 [info ] [Thread-1 (]: 7 of 28 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m11:00:28.693615 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m11:00:28.694175 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m11:00:28.694677 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m11:00:28.700838 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m11:00:28.704052 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:28.704711 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m11:00:28.711340 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m11:00:28.714037 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m11:00:28.714552 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m11:00:28.715011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:28.737703 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m11:00:28.738374 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m11:00:28.738934 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."jaffle_shop"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m11:00:28.765804 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m11:00:28.772452 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:28.773997 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m11:00:28.775873 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m11:00:28.776662 [info ] [Thread-1 (]: 7 of 28 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.08s]
[0m11:00:28.777290 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m11:00:28.777722 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m11:00:28.778176 [info ] [Thread-1 (]: 8 of 28 START test unique_stg_customers_customer_id ............................ [RUN]
[0m11:00:28.778842 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m11:00:28.779316 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m11:00:28.779712 [debug] [Thread-1 (]: Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m11:00:28.783432 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m11:00:28.785529 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:28.786059 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m11:00:28.787612 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m11:00:28.789210 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m11:00:28.789649 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m11:00:28.790100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:28.811965 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m11:00:28.812731 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m11:00:28.813325 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "postgres"."jaffle_shop"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:00:28.839428 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m11:00:28.840834 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:28.841577 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m11:00:28.842808 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m11:00:28.844114 [info ] [Thread-1 (]: 8 of 28 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.07s]
[0m11:00:28.845129 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m11:00:28.845935 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m11:00:28.846943 [info ] [Thread-1 (]: 9 of 28 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [RUN]
[0m11:00:28.848090 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m11:00:28.848584 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m11:00:28.849054 [debug] [Thread-1 (]: Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m11:00:28.855113 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m11:00:28.857248 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:28.857930 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m11:00:28.859640 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m11:00:28.861348 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m11:00:28.861793 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: BEGIN
[0m11:00:28.862197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:28.886378 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m11:00:28.887217 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m11:00:28.887843 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "postgres"."jaffle_shop"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
[0m11:00:28.924779 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.04 seconds
[0m11:00:28.926372 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:28.927166 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: ROLLBACK
[0m11:00:28.928418 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: Close
[0m11:00:28.929290 [info ] [Thread-1 (]: 9 of 28 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [[32mPASS[0m in 0.08s]
[0m11:00:28.929987 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m11:00:28.930582 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m11:00:28.931174 [info ] [Thread-1 (]: 10 of 28 START test not_null_stg_orders_order_id ............................... [RUN]
[0m11:00:28.932087 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:00:28.932959 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m11:00:28.933541 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m11:00:28.936155 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:00:28.938149 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:28.938757 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m11:00:28.940394 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:00:28.942202 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:00:28.942651 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m11:00:28.943083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:28.964692 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m11:00:28.965391 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:00:28.966060 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "postgres"."jaffle_shop"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m11:00:28.987761 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m11:00:28.989107 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:28.989756 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m11:00:28.990938 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m11:00:28.991752 [info ] [Thread-1 (]: 10 of 28 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.06s]
[0m11:00:28.992467 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m11:00:28.993089 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m11:00:28.993637 [info ] [Thread-1 (]: 11 of 28 START test unique_stg_orders_order_id ................................. [RUN]
[0m11:00:28.994409 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m11:00:28.994965 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m11:00:28.995482 [debug] [Thread-1 (]: Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m11:00:28.998016 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m11:00:29.000054 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:29.000613 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m11:00:29.002212 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m11:00:29.003817 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m11:00:29.004272 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m11:00:29.004706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:29.026085 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m11:00:29.026788 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m11:00:29.027367 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "postgres"."jaffle_shop"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:00:29.053513 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m11:00:29.054957 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:29.055624 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m11:00:29.056837 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m11:00:29.057666 [info ] [Thread-1 (]: 11 of 28 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.06s]
[0m11:00:29.058379 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m11:00:29.058912 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m11:00:29.059446 [info ] [Thread-1 (]: 12 of 28 START test accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card  [RUN]
[0m11:00:29.060296 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m11:00:29.060840 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m11:00:29.061409 [debug] [Thread-1 (]: Compiling test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m11:00:29.065582 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m11:00:29.067719 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:29.068259 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m11:00:29.069754 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m11:00:29.071339 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m11:00:29.071782 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: BEGIN
[0m11:00:29.072260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:29.094047 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m11:00:29.094778 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m11:00:29.095312 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_method as value_field,
        count(*) as n_records

    from "postgres"."jaffle_shop"."stg_payments"
    group by payment_method

)

select *
from all_values
where value_field not in (
    'credit_card','coupon','bank_transfer','gift_card'
)



      
    ) dbt_internal_test
[0m11:00:29.128402 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m11:00:29.131894 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:29.132593 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: ROLLBACK
[0m11:00:29.133846 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: Close
[0m11:00:29.134794 [info ] [Thread-1 (]: 12 of 28 PASS accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card  [[32mPASS[0m in 0.07s]
[0m11:00:29.135585 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m11:00:29.136184 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m11:00:29.136903 [info ] [Thread-1 (]: 13 of 28 START test not_null_stg_payments_payment_id ........................... [RUN]
[0m11:00:29.137769 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m11:00:29.138333 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m11:00:29.139009 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m11:00:29.141934 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m11:00:29.143914 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:29.144505 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m11:00:29.146100 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m11:00:29.148226 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m11:00:29.148696 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m11:00:29.149143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:29.170690 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m11:00:29.171339 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m11:00:29.171976 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "postgres"."jaffle_shop"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
[0m11:00:29.194037 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m11:00:29.195290 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:29.195844 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m11:00:29.197077 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075: Close
[0m11:00:29.197909 [info ] [Thread-1 (]: 13 of 28 PASS not_null_stg_payments_payment_id ................................. [[32mPASS[0m in 0.06s]
[0m11:00:29.198692 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m11:00:29.199267 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m11:00:29.199857 [info ] [Thread-1 (]: 14 of 28 START test unique_stg_payments_payment_id ............................. [RUN]
[0m11:00:29.200627 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m11:00:29.201426 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m11:00:29.201994 [debug] [Thread-1 (]: Compiling test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m11:00:29.204645 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m11:00:29.206651 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:29.207207 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m11:00:29.208697 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m11:00:29.210270 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m11:00:29.210715 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_payments_payment_id.3744510712: BEGIN
[0m11:00:29.211124 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:29.233088 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m11:00:29.233751 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m11:00:29.234391 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "postgres"."jaffle_shop"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:00:29.260292 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m11:00:29.261617 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:29.262291 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m11:00:29.263553 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_payments_payment_id.3744510712: Close
[0m11:00:29.264397 [info ] [Thread-1 (]: 14 of 28 PASS unique_stg_payments_payment_id ................................... [[32mPASS[0m in 0.06s]
[0m11:00:29.265191 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m11:00:29.266270 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m11:00:29.266966 [info ] [Thread-1 (]: 15 of 28 START sql table model jaffle_shop.customers ........................... [RUN]
[0m11:00:29.267800 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.customers"
[0m11:00:29.268383 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m11:00:29.268992 [debug] [Thread-1 (]: Compiling model.jaffle_shop.customers
[0m11:00:29.271451 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m11:00:29.273757 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:29.274349 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m11:00:29.284366 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m11:00:29.286746 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m11:00:29.287378 [debug] [Thread-1 (]: On model.jaffle_shop.customers: BEGIN
[0m11:00:29.287905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:29.310005 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m11:00:29.310657 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m11:00:29.311180 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  
    

  create  table "postgres"."jaffle_shop"."customers__dbt_tmp"
  as (
    with customers as (

    select * from "postgres"."jaffle_shop"."stg_customers"

),

orders as (

    select * from "postgres"."jaffle_shop"."stg_orders"

),

payments as (

    select * from "postgres"."jaffle_shop"."stg_payments"

),

customer_orders as (

        select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by customer_id

),

customer_payments as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders on
         payments.order_id = orders.order_id

    group by orders.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders
        on customers.customer_id = customer_orders.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
  
[0m11:00:29.365759 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.05 seconds
[0m11:00:29.368993 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m11:00:29.369716 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
alter table "postgres"."jaffle_shop"."customers__dbt_tmp" rename to "customers"
[0m11:00:29.371521 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:00:29.372802 [debug] [Thread-1 (]: On model.jaffle_shop.customers: COMMIT
[0m11:00:29.373420 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m11:00:29.374010 [debug] [Thread-1 (]: On model.jaffle_shop.customers: COMMIT
[0m11:00:29.376236 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:00:29.378128 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.customers"
[0m11:00:29.378613 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
drop table if exists "postgres"."jaffle_shop"."customers__dbt_backup" cascade
[0m11:00:29.379709 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:00:29.380592 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:29.381043 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m11:00:29.381731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '113735c3-7e71-4de7-88a3-f14c46d10899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a63bb50>]}
[0m11:00:29.382318 [info ] [Thread-1 (]: 15 of 28 OK created sql table model jaffle_shop.customers ...................... [[32mSELECT 100[0m in 0.11s]
[0m11:00:29.382983 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m11:00:29.383462 [debug] [Thread-1 (]: Began running node model.jaffle_shop.orders
[0m11:00:29.383983 [info ] [Thread-1 (]: 16 of 28 START sql table model jaffle_shop.orders .............................. [RUN]
[0m11:00:29.384654 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.orders"
[0m11:00:29.385105 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.orders
[0m11:00:29.385579 [debug] [Thread-1 (]: Compiling model.jaffle_shop.orders
[0m11:00:29.388153 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.orders"
[0m11:00:29.390234 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:29.390822 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.orders
[0m11:00:29.393345 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.orders"
[0m11:00:29.394979 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.orders"
[0m11:00:29.395432 [debug] [Thread-1 (]: On model.jaffle_shop.orders: BEGIN
[0m11:00:29.395907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:29.418153 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m11:00:29.418863 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.orders"
[0m11:00:29.419465 [debug] [Thread-1 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.orders"} */

  
    

  create  table "postgres"."jaffle_shop"."orders__dbt_tmp"
  as (
    

with orders as (

    select * from "postgres"."jaffle_shop"."stg_orders"

),

payments as (

    select * from "postgres"."jaffle_shop"."stg_payments"

),

order_payments as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by order_id

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders


    left join order_payments
        on orders.order_id = order_payments.order_id

)

select * from final
  );
  
[0m11:00:29.475120 [debug] [Thread-1 (]: SQL status: SELECT 99 in 0.06 seconds
[0m11:00:29.477938 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.orders"
[0m11:00:29.479120 [debug] [Thread-1 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.orders"} */
alter table "postgres"."jaffle_shop"."orders__dbt_tmp" rename to "orders"
[0m11:00:29.481254 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:00:29.482919 [debug] [Thread-1 (]: On model.jaffle_shop.orders: COMMIT
[0m11:00:29.483516 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.orders"
[0m11:00:29.484376 [debug] [Thread-1 (]: On model.jaffle_shop.orders: COMMIT
[0m11:00:29.487078 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:00:29.488790 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.orders"
[0m11:00:29.489565 [debug] [Thread-1 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.orders"} */
drop table if exists "postgres"."jaffle_shop"."orders__dbt_backup" cascade
[0m11:00:29.490952 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:00:29.492091 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:29.492592 [debug] [Thread-1 (]: On model.jaffle_shop.orders: Close
[0m11:00:29.493379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '113735c3-7e71-4de7-88a3-f14c46d10899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff977bb580>]}
[0m11:00:29.494436 [info ] [Thread-1 (]: 16 of 28 OK created sql table model jaffle_shop.orders ......................... [[32mSELECT 99[0m in 0.11s]
[0m11:00:29.495328 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.orders
[0m11:00:29.495973 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m11:00:29.497090 [info ] [Thread-1 (]: 17 of 28 START test not_null_customers_customer_id ............................. [RUN]
[0m11:00:29.498053 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m11:00:29.498660 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m11:00:29.499232 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m11:00:29.502041 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m11:00:29.504916 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:29.505522 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m11:00:29.508081 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m11:00:29.510689 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m11:00:29.511171 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: BEGIN
[0m11:00:29.511585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:29.534305 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m11:00:29.534976 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m11:00:29.535668 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."jaffle_shop"."customers"
where customer_id is null



      
    ) dbt_internal_test
[0m11:00:29.553013 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m11:00:29.554338 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:29.554987 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: ROLLBACK
[0m11:00:29.556167 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: Close
[0m11:00:29.556942 [info ] [Thread-1 (]: 17 of 28 PASS not_null_customers_customer_id ................................... [[32mPASS[0m in 0.06s]
[0m11:00:29.557638 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m11:00:29.558212 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m11:00:29.558693 [info ] [Thread-1 (]: 18 of 28 START test unique_customers_customer_id ............................... [RUN]
[0m11:00:29.559494 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m11:00:29.560051 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m11:00:29.560702 [debug] [Thread-1 (]: Compiling test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m11:00:29.563484 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m11:00:29.565458 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:29.565997 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m11:00:29.567727 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m11:00:29.569393 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m11:00:29.569870 [debug] [Thread-1 (]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: BEGIN
[0m11:00:29.570303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:29.592149 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m11:00:29.593006 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m11:00:29.594143 [debug] [Thread-1 (]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "postgres"."jaffle_shop"."customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:00:29.617638 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m11:00:29.619255 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:29.619956 [debug] [Thread-1 (]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: ROLLBACK
[0m11:00:29.621159 [debug] [Thread-1 (]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: Close
[0m11:00:29.622004 [info ] [Thread-1 (]: 18 of 28 PASS unique_customers_customer_id ..................................... [[32mPASS[0m in 0.06s]
[0m11:00:29.622738 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m11:00:29.623267 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3
[0m11:00:29.623844 [info ] [Thread-1 (]: 19 of 28 START test accepted_values_orders_status__placed__shipped__completed__return_pending__returned  [RUN]
[0m11:00:29.624648 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3"
[0m11:00:29.625229 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3
[0m11:00:29.625781 [debug] [Thread-1 (]: Compiling test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3
[0m11:00:29.629600 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3"
[0m11:00:29.631666 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:29.632194 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3
[0m11:00:29.633658 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3"
[0m11:00:29.635557 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3"
[0m11:00:29.636010 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3: BEGIN
[0m11:00:29.636513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:29.658288 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m11:00:29.658927 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3"
[0m11:00:29.659547 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "postgres"."jaffle_shop"."orders"
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
[0m11:00:29.685951 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m11:00:29.687299 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:29.687966 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3: ROLLBACK
[0m11:00:29.689084 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3: Close
[0m11:00:29.689999 [info ] [Thread-1 (]: 19 of 28 PASS accepted_values_orders_status__placed__shipped__completed__return_pending__returned  [[32mPASS[0m in 0.07s]
[0m11:00:29.690777 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3
[0m11:00:29.691481 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_orders_amount.106140f9fd
[0m11:00:29.692041 [info ] [Thread-1 (]: 20 of 28 START test not_null_orders_amount ..................................... [RUN]
[0m11:00:29.692792 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_orders_amount.106140f9fd"
[0m11:00:29.693408 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_orders_amount.106140f9fd
[0m11:00:29.693973 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_orders_amount.106140f9fd
[0m11:00:29.696940 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_amount.106140f9fd"
[0m11:00:29.698891 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:29.699439 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_orders_amount.106140f9fd
[0m11:00:29.701126 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_amount.106140f9fd"
[0m11:00:29.702902 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_orders_amount.106140f9fd"
[0m11:00:29.703365 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_orders_amount.106140f9fd: BEGIN
[0m11:00:29.703810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:29.725454 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m11:00:29.726108 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_orders_amount.106140f9fd"
[0m11:00:29.726719 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_orders_amount.106140f9fd: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_orders_amount.106140f9fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select amount
from "postgres"."jaffle_shop"."orders"
where amount is null



      
    ) dbt_internal_test
[0m11:00:29.743798 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m11:00:29.745172 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:29.745858 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_orders_amount.106140f9fd: ROLLBACK
[0m11:00:29.746919 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_orders_amount.106140f9fd: Close
[0m11:00:29.747781 [info ] [Thread-1 (]: 20 of 28 PASS not_null_orders_amount ........................................... [[32mPASS[0m in 0.06s]
[0m11:00:29.748509 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_orders_amount.106140f9fd
[0m11:00:29.749157 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49
[0m11:00:29.749789 [info ] [Thread-1 (]: 21 of 28 START test not_null_orders_bank_transfer_amount ....................... [RUN]
[0m11:00:29.751025 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49"
[0m11:00:29.751562 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49
[0m11:00:29.752076 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49
[0m11:00:29.754898 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49"
[0m11:00:29.756847 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:29.757382 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49
[0m11:00:29.759746 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49"
[0m11:00:29.761240 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49"
[0m11:00:29.761716 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49: BEGIN
[0m11:00:29.762177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:29.783751 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m11:00:29.784528 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49"
[0m11:00:29.785115 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select bank_transfer_amount
from "postgres"."jaffle_shop"."orders"
where bank_transfer_amount is null



      
    ) dbt_internal_test
[0m11:00:29.802735 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m11:00:29.804238 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:29.804867 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49: ROLLBACK
[0m11:00:29.805988 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49: Close
[0m11:00:29.807263 [info ] [Thread-1 (]: 21 of 28 PASS not_null_orders_bank_transfer_amount ............................. [[32mPASS[0m in 0.06s]
[0m11:00:29.808273 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49
[0m11:00:29.808832 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625
[0m11:00:29.809463 [info ] [Thread-1 (]: 22 of 28 START test not_null_orders_coupon_amount .............................. [RUN]
[0m11:00:29.810300 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625"
[0m11:00:29.810876 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625
[0m11:00:29.811397 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625
[0m11:00:29.813963 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625"
[0m11:00:29.816167 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:29.816693 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625
[0m11:00:29.818174 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625"
[0m11:00:29.819807 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625"
[0m11:00:29.820255 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625: BEGIN
[0m11:00:29.820663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:29.842221 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m11:00:29.844509 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625"
[0m11:00:29.845091 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select coupon_amount
from "postgres"."jaffle_shop"."orders"
where coupon_amount is null



      
    ) dbt_internal_test
[0m11:00:29.861917 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m11:00:29.863252 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:29.863830 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625: ROLLBACK
[0m11:00:29.865059 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625: Close
[0m11:00:29.865867 [info ] [Thread-1 (]: 22 of 28 PASS not_null_orders_coupon_amount .................................... [[32mPASS[0m in 0.06s]
[0m11:00:29.866618 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625
[0m11:00:29.867180 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59
[0m11:00:29.867739 [info ] [Thread-1 (]: 23 of 28 START test not_null_orders_credit_card_amount ......................... [RUN]
[0m11:00:29.868593 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59"
[0m11:00:29.869179 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59
[0m11:00:29.869816 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59
[0m11:00:29.872601 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59"
[0m11:00:29.874575 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:29.875036 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59
[0m11:00:29.876512 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59"
[0m11:00:29.878091 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59"
[0m11:00:29.878534 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59: BEGIN
[0m11:00:29.878927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:29.900729 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m11:00:29.901387 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59"
[0m11:00:29.902002 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select credit_card_amount
from "postgres"."jaffle_shop"."orders"
where credit_card_amount is null



      
    ) dbt_internal_test
[0m11:00:29.919392 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m11:00:29.920644 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:29.921180 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59: ROLLBACK
[0m11:00:29.922230 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59: Close
[0m11:00:29.922952 [info ] [Thread-1 (]: 23 of 28 PASS not_null_orders_credit_card_amount ............................... [[32mPASS[0m in 0.05s]
[0m11:00:29.923940 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59
[0m11:00:29.924457 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_orders_customer_id.c5f02694af
[0m11:00:29.924939 [info ] [Thread-1 (]: 24 of 28 START test not_null_orders_customer_id ................................ [RUN]
[0m11:00:29.925591 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_orders_customer_id.c5f02694af"
[0m11:00:29.926131 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_orders_customer_id.c5f02694af
[0m11:00:29.926601 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_orders_customer_id.c5f02694af
[0m11:00:29.929174 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_customer_id.c5f02694af"
[0m11:00:29.931171 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:29.931691 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_orders_customer_id.c5f02694af
[0m11:00:29.933086 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_customer_id.c5f02694af"
[0m11:00:29.934788 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_orders_customer_id.c5f02694af"
[0m11:00:29.935221 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_orders_customer_id.c5f02694af: BEGIN
[0m11:00:29.935605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:29.958104 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m11:00:29.958867 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_orders_customer_id.c5f02694af"
[0m11:00:29.959760 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_orders_customer_id.c5f02694af: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_orders_customer_id.c5f02694af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."jaffle_shop"."orders"
where customer_id is null



      
    ) dbt_internal_test
[0m11:00:29.977463 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m11:00:29.979046 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:29.979700 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_orders_customer_id.c5f02694af: ROLLBACK
[0m11:00:29.980937 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_orders_customer_id.c5f02694af: Close
[0m11:00:29.981772 [info ] [Thread-1 (]: 24 of 28 PASS not_null_orders_customer_id ...................................... [[32mPASS[0m in 0.06s]
[0m11:00:29.982457 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_orders_customer_id.c5f02694af
[0m11:00:29.982994 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a
[0m11:00:29.983501 [info ] [Thread-1 (]: 25 of 28 START test not_null_orders_gift_card_amount ........................... [RUN]
[0m11:00:29.984315 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a"
[0m11:00:29.984891 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a
[0m11:00:29.985506 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a
[0m11:00:29.989446 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a"
[0m11:00:29.991461 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:29.992028 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a
[0m11:00:29.993558 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a"
[0m11:00:29.995371 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a"
[0m11:00:29.995998 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a: BEGIN
[0m11:00:29.996463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:30.018331 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m11:00:30.019021 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a"
[0m11:00:30.019668 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select gift_card_amount
from "postgres"."jaffle_shop"."orders"
where gift_card_amount is null



      
    ) dbt_internal_test
[0m11:00:30.037095 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m11:00:30.038418 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:30.039076 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a: ROLLBACK
[0m11:00:30.040310 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a: Close
[0m11:00:30.041220 [info ] [Thread-1 (]: 25 of 28 PASS not_null_orders_gift_card_amount ................................. [[32mPASS[0m in 0.06s]
[0m11:00:30.041911 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a
[0m11:00:30.042534 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m11:00:30.043104 [info ] [Thread-1 (]: 26 of 28 START test not_null_orders_order_id ................................... [RUN]
[0m11:00:30.043933 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.not_null_orders_order_id.cf6c17daed"
[0m11:00:30.044511 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m11:00:30.045127 [debug] [Thread-1 (]: Compiling test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m11:00:30.047815 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_order_id.cf6c17daed"
[0m11:00:30.049896 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:30.050508 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m11:00:30.052100 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_order_id.cf6c17daed"
[0m11:00:30.054172 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_orders_order_id.cf6c17daed"
[0m11:00:30.054634 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_orders_order_id.cf6c17daed: BEGIN
[0m11:00:30.055059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:30.076735 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m11:00:30.077448 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_orders_order_id.cf6c17daed"
[0m11:00:30.078081 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_orders_order_id.cf6c17daed: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_orders_order_id.cf6c17daed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "postgres"."jaffle_shop"."orders"
where order_id is null



      
    ) dbt_internal_test
[0m11:00:30.095653 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m11:00:30.096918 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:30.097560 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_orders_order_id.cf6c17daed: ROLLBACK
[0m11:00:30.098806 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_orders_order_id.cf6c17daed: Close
[0m11:00:30.099727 [info ] [Thread-1 (]: 26 of 28 PASS not_null_orders_order_id ......................................... [[32mPASS[0m in 0.06s]
[0m11:00:30.100746 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m11:00:30.101392 [debug] [Thread-1 (]: Began running node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m11:00:30.101994 [info ] [Thread-1 (]: 27 of 28 START test relationships_orders_customer_id__customer_id__ref_customers_  [RUN]
[0m11:00:30.102755 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m11:00:30.103338 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m11:00:30.103921 [debug] [Thread-1 (]: Compiling test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m11:00:30.108610 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m11:00:30.110687 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:30.111214 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m11:00:30.112720 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m11:00:30.114490 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m11:00:30.114959 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2: BEGIN
[0m11:00:30.115434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:30.138581 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m11:00:30.139418 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m11:00:30.140026 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "postgres"."jaffle_shop"."orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "postgres"."jaffle_shop"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m11:00:30.167254 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m11:00:30.168750 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:30.169528 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2: ROLLBACK
[0m11:00:30.170802 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2: Close
[0m11:00:30.171713 [info ] [Thread-1 (]: 27 of 28 PASS relationships_orders_customer_id__customer_id__ref_customers_ .... [[32mPASS[0m in 0.07s]
[0m11:00:30.172614 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m11:00:30.173300 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m11:00:30.173986 [info ] [Thread-1 (]: 28 of 28 START test unique_orders_order_id ..................................... [RUN]
[0m11:00:30.174750 [debug] [Thread-1 (]: Acquiring new postgres connection "test.jaffle_shop.unique_orders_order_id.fed79b3a6e"
[0m11:00:30.175559 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m11:00:30.176050 [debug] [Thread-1 (]: Compiling test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m11:00:30.178651 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_orders_order_id.fed79b3a6e"
[0m11:00:30.180785 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:30.181359 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m11:00:30.182773 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_orders_order_id.fed79b3a6e"
[0m11:00:30.184431 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_orders_order_id.fed79b3a6e"
[0m11:00:30.184829 [debug] [Thread-1 (]: On test.jaffle_shop.unique_orders_order_id.fed79b3a6e: BEGIN
[0m11:00:30.185327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:30.206940 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m11:00:30.207736 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_orders_order_id.fed79b3a6e"
[0m11:00:30.208287 [debug] [Thread-1 (]: On test.jaffle_shop.unique_orders_order_id.fed79b3a6e: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_orders_order_id.fed79b3a6e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "postgres"."jaffle_shop"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:00:30.230859 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m11:00:30.232210 [debug] [Thread-1 (]: finished collecting timing info
[0m11:00:30.232899 [debug] [Thread-1 (]: On test.jaffle_shop.unique_orders_order_id.fed79b3a6e: ROLLBACK
[0m11:00:30.234035 [debug] [Thread-1 (]: On test.jaffle_shop.unique_orders_order_id.fed79b3a6e: Close
[0m11:00:30.234861 [info ] [Thread-1 (]: 28 of 28 PASS unique_orders_order_id ........................................... [[32mPASS[0m in 0.06s]
[0m11:00:30.235563 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m11:00:30.236811 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:00:30.237440 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:30.237974 [debug] [MainThread]: On master: BEGIN
[0m11:00:30.238500 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:00:30.259666 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m11:00:30.260307 [debug] [MainThread]: On master: COMMIT
[0m11:00:30.260917 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:30.261465 [debug] [MainThread]: On master: COMMIT
[0m11:00:30.263014 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:00:30.263590 [debug] [MainThread]: On master: Close
[0m11:00:30.264489 [info ] [MainThread]: 
[0m11:00:30.267669 [info ] [MainThread]: Finished running 3 seeds, 3 view models, 20 tests, 2 table models in 0 hours 0 minutes and 7.57 seconds (7.57s).
[0m11:00:30.268576 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:00:30.269299 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_orders_order_id.fed79b3a6e' was properly closed.
[0m11:00:30.282394 [info ] [MainThread]: 
[0m11:00:30.282977 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:00:30.283569 [info ] [MainThread]: 
[0m11:00:30.284124 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=0 SKIP=0 TOTAL=28
[0m11:00:30.284705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97797e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97797dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9545bfa0>]}
[0m11:00:30.285472 [debug] [MainThread]: Flushing usage events


============================== 2023-06-16 11:02:40.801672 | 33044fe6-ec1e-408f-95bc-52642e9ea73c ==============================
[0m11:02:40.801680 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:02:40.802637 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m11:02:40.803295 [debug] [MainThread]: Tracking: tracking
[0m11:02:40.805281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98323a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98321e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff983204f0>]}
[0m11:02:40.812406 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-cby74_ty'
[0m11:02:40.813124 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:02:41.001250 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:02:41.003382 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:02:41.136695 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:02:41.171287 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m11:02:42.467903 [info ] [MainThread]:   Installed from version 1.0.0
[0m11:02:42.468587 [info ] [MainThread]:   Updated version available: 1.1.1
[0m11:02:42.469187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '33044fe6-ec1e-408f-95bc-52642e9ea73c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98323400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff983219f0>]}
[0m11:02:42.469802 [info ] [MainThread]: 
[0m11:02:42.470294 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m11:02:42.471437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff983559c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98320a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98320730>]}
[0m11:02:42.472203 [debug] [MainThread]: Flushing usage events


============================== 2023-06-16 11:02:45.262635 | ce3fac70-60cb-4a66-b94a-eba182020a69 ==============================
[0m11:02:45.262644 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:02:45.263263 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/jaffle_shop/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m11:02:45.264674 [debug] [MainThread]: Tracking: tracking
[0m11:02:45.266909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b88f940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b88f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b88f8b0>]}
[0m11:02:45.362771 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:02:45.363462 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:02:45.369136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce3fac70-60cb-4a66-b94a-eba182020a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ad001f0>]}
[0m11:02:45.385841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce3fac70-60cb-4a66-b94a-eba182020a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7acbee60>]}
[0m11:02:45.386895 [info ] [MainThread]: Found 5 models, 20 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:02:45.387769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce3fac70-60cb-4a66-b94a-eba182020a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7acbeec0>]}
[0m11:02:45.390155 [info ] [MainThread]: 
[0m11:02:45.391031 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:02:45.392289 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m11:02:45.398688 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:02:45.399513 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:02:45.400229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:03:00.649290 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "postgres" (125.235.4.59), port 5432 failed: timeout expired

